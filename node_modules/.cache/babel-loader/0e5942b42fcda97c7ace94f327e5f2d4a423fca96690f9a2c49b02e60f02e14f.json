{"ast":null,"code":"/**\r\n * Data Service for Mechanic Hours App\r\n * Handles all data persistence and manipulation\r\n * Reference: www.context7.com for data management best practices\r\n */const STORAGE_KEY='mechanicHoursData';// Default data structure\nconst DEFAULT_DATA={clients:[],tasks:[],entries:[],active:null};export const dataService={/**\r\n   * Load data from localStorage\r\n   * @returns {Object} Application data\r\n   */loadData(){try{const data=localStorage.getItem(STORAGE_KEY);return data?JSON.parse(data):DEFAULT_DATA;}catch(error){console.error('Error loading data:',error);return DEFAULT_DATA;}},/**\r\n   * Save data to localStorage\r\n   * @param {Object} data - Application data to save\r\n   */saveData(data){try{localStorage.setItem(STORAGE_KEY,JSON.stringify(data));}catch(error){console.error('Error saving data:',error);}},/**\r\n   * Generate unique ID\r\n   * @returns {string} Unique identifier\r\n   */generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2);},/**\r\n   * Format duration from milliseconds to readable string\r\n   * @param {number} duration - Duration in milliseconds\r\n   * @returns {string} Formatted duration (e.g., \"2h 30m\")\r\n   */formatDuration(duration){if(!duration||duration<0)return'0m';const hours=Math.floor(duration/(1000*60*60));const minutes=Math.floor(duration%(1000*60*60)/(1000*60));if(hours===0){return\"\".concat(minutes,\"m\");}else if(minutes===0){return\"\".concat(hours,\"h\");}else{return\"\".concat(hours,\"h \").concat(minutes,\"m\");}},/**\r\n   * Convert duration to decimal hours for billing\r\n   * @param {number} duration - Duration in milliseconds\r\n   * @returns {number} Duration in decimal hours\r\n   */durationToHours(duration){return duration/(1000*60*60);},/**\r\n   * Format currency amount\r\n   * @param {number} amount - Amount to format\r\n   * @returns {string} Formatted currency string\r\n   */formatCurrency(amount){return new Intl.NumberFormat('en-US',{style:'currency',currency:'USD'}).format(amount);},/**\r\n   * Format date for display\r\n   * @param {number|Date} date - Date to format\r\n   * @returns {string} Formatted date string\r\n   */formatDate(date){const dateObj=typeof date==='number'?new Date(date):date;return dateObj.toLocaleDateString('en-US',{year:'numeric',month:'short',day:'numeric'});},/**\r\n   * Format time for display\r\n   * @param {number|Date} date - Date to format\r\n   * @returns {string} Formatted time string\r\n   */formatTime(date){const dateObj=typeof date==='number'?new Date(date):date;return dateObj.toLocaleTimeString('en-US',{hour:'2-digit',minute:'2-digit'});},/**\r\n   * Get entries for a specific date range\r\n   * @param {Object[]} entries - All entries\r\n   * @param {Date} startDate - Start date\r\n   * @param {Date} endDate - End date\r\n   * @returns {Object[]} Filtered entries\r\n   */getEntriesInRange(entries,startDate,endDate){return entries.filter(entry=>{const entryDate=new Date(entry.start);return entryDate>=startDate&&entryDate<=endDate;});},/**\r\n   * Calculate total hours for entries\r\n   * @param {Object[]} entries - Entries to calculate\r\n   * @returns {number} Total hours\r\n   */calculateTotalHours(entries){return entries.reduce((total,entry)=>{if(entry.end&&entry.start){return total+this.durationToHours(entry.end-entry.start);}return total;},0);},/**\r\n   * Calculate total amount for entries with client rates\r\n   * @param {Object[]} entries - Entries to calculate\r\n   * @param {Object[]} clients - Client data with rates\r\n   * @returns {number} Total amount\r\n   */calculateTotalAmount(entries,clients){return entries.reduce((total,entry)=>{if(entry.end&&entry.start){const client=clients.find(c=>c.id===entry.clientId);if(client&&client.rate){const hours=this.durationToHours(entry.end-entry.start);return total+hours*client.rate;}}return total;},0);},/**\r\n   * Export data as JSON for backup\r\n   * @param {Object} data - Application data\r\n   * @returns {string} JSON string\r\n   */exportData(data){try{return JSON.stringify(data,null,2);}catch(error){console.error('Error exporting data:',error);return null;}},/**\r\n   * Import data from JSON backup\r\n   * @param {string} jsonString - JSON data string\r\n   * @returns {Object|null} Parsed data or null if invalid\r\n   */importData(jsonString){try{const data=JSON.parse(jsonString);// Validate data structure\nif(data&&typeof data==='object'&&Array.isArray(data.clients)&&Array.isArray(data.tasks)&&Array.isArray(data.entries)){return data;}return null;}catch(error){console.error('Error importing data:',error);return null;}}};","map":{"version":3,"names":["STORAGE_KEY","DEFAULT_DATA","clients","tasks","entries","active","dataService","loadData","data","localStorage","getItem","JSON","parse","error","console","saveData","setItem","stringify","generateId","Date","now","toString","Math","random","substr","formatDuration","duration","hours","floor","minutes","concat","durationToHours","formatCurrency","amount","Intl","NumberFormat","style","currency","format","formatDate","date","dateObj","toLocaleDateString","year","month","day","formatTime","toLocaleTimeString","hour","minute","getEntriesInRange","startDate","endDate","filter","entry","entryDate","start","calculateTotalHours","reduce","total","end","calculateTotalAmount","client","find","c","id","clientId","rate","exportData","importData","jsonString","Array","isArray"],"sources":["C:/Users/jurgl/HTMLProjects/CrickTime/src/utils/dataService.js"],"sourcesContent":["/**\r\n * Data Service for Mechanic Hours App\r\n * Handles all data persistence and manipulation\r\n * Reference: www.context7.com for data management best practices\r\n */\r\n\r\nconst STORAGE_KEY = 'mechanicHoursData';\r\n\r\n// Default data structure\r\nconst DEFAULT_DATA = {\r\n  clients: [],\r\n  tasks: [],\r\n  entries: [],\r\n  active: null\r\n};\r\n\r\nexport const dataService = {\r\n  /**\r\n   * Load data from localStorage\r\n   * @returns {Object} Application data\r\n   */\r\n  loadData() {\r\n    try {\r\n      const data = localStorage.getItem(STORAGE_KEY);\r\n      return data ? JSON.parse(data) : DEFAULT_DATA;\r\n    } catch (error) {\r\n      console.error('Error loading data:', error);\r\n      return DEFAULT_DATA;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Save data to localStorage\r\n   * @param {Object} data - Application data to save\r\n   */\r\n  saveData(data) {\r\n    try {\r\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));\r\n    } catch (error) {\r\n      console.error('Error saving data:', error);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Generate unique ID\r\n   * @returns {string} Unique identifier\r\n   */\r\n  generateId() {\r\n    return Date.now().toString(36) + Math.random().toString(36).substr(2);\r\n  },\r\n\r\n  /**\r\n   * Format duration from milliseconds to readable string\r\n   * @param {number} duration - Duration in milliseconds\r\n   * @returns {string} Formatted duration (e.g., \"2h 30m\")\r\n   */\r\n  formatDuration(duration) {\r\n    if (!duration || duration < 0) return '0m';\r\n    \r\n    const hours = Math.floor(duration / (1000 * 60 * 60));\r\n    const minutes = Math.floor((duration % (1000 * 60 * 60)) / (1000 * 60));\r\n    \r\n    if (hours === 0) {\r\n      return `${minutes}m`;\r\n    } else if (minutes === 0) {\r\n      return `${hours}h`;\r\n    } else {\r\n      return `${hours}h ${minutes}m`;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Convert duration to decimal hours for billing\r\n   * @param {number} duration - Duration in milliseconds\r\n   * @returns {number} Duration in decimal hours\r\n   */\r\n  durationToHours(duration) {\r\n    return duration / (1000 * 60 * 60);\r\n  },\r\n\r\n  /**\r\n   * Format currency amount\r\n   * @param {number} amount - Amount to format\r\n   * @returns {string} Formatted currency string\r\n   */\r\n  formatCurrency(amount) {\r\n    return new Intl.NumberFormat('en-US', {\r\n      style: 'currency',\r\n      currency: 'USD'\r\n    }).format(amount);\r\n  },\r\n\r\n  /**\r\n   * Format date for display\r\n   * @param {number|Date} date - Date to format\r\n   * @returns {string} Formatted date string\r\n   */\r\n  formatDate(date) {\r\n    const dateObj = typeof date === 'number' ? new Date(date) : date;\r\n    return dateObj.toLocaleDateString('en-US', {\r\n      year: 'numeric',\r\n      month: 'short',\r\n      day: 'numeric'\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Format time for display\r\n   * @param {number|Date} date - Date to format\r\n   * @returns {string} Formatted time string\r\n   */\r\n  formatTime(date) {\r\n    const dateObj = typeof date === 'number' ? new Date(date) : date;\r\n    return dateObj.toLocaleTimeString('en-US', {\r\n      hour: '2-digit',\r\n      minute: '2-digit'\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Get entries for a specific date range\r\n   * @param {Object[]} entries - All entries\r\n   * @param {Date} startDate - Start date\r\n   * @param {Date} endDate - End date\r\n   * @returns {Object[]} Filtered entries\r\n   */\r\n  getEntriesInRange(entries, startDate, endDate) {\r\n    return entries.filter(entry => {\r\n      const entryDate = new Date(entry.start);\r\n      return entryDate >= startDate && entryDate <= endDate;\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Calculate total hours for entries\r\n   * @param {Object[]} entries - Entries to calculate\r\n   * @returns {number} Total hours\r\n   */\r\n  calculateTotalHours(entries) {\r\n    return entries.reduce((total, entry) => {\r\n      if (entry.end && entry.start) {\r\n        return total + this.durationToHours(entry.end - entry.start);\r\n      }\r\n      return total;\r\n    }, 0);\r\n  },\r\n\r\n  /**\r\n   * Calculate total amount for entries with client rates\r\n   * @param {Object[]} entries - Entries to calculate\r\n   * @param {Object[]} clients - Client data with rates\r\n   * @returns {number} Total amount\r\n   */\r\n  calculateTotalAmount(entries, clients) {\r\n    return entries.reduce((total, entry) => {\r\n      if (entry.end && entry.start) {\r\n        const client = clients.find(c => c.id === entry.clientId);\r\n        if (client && client.rate) {\r\n          const hours = this.durationToHours(entry.end - entry.start);\r\n          return total + (hours * client.rate);\r\n        }\r\n      }\r\n      return total;\r\n    }, 0);\r\n  },\r\n\r\n  /**\r\n   * Export data as JSON for backup\r\n   * @param {Object} data - Application data\r\n   * @returns {string} JSON string\r\n   */\r\n  exportData(data) {\r\n    try {\r\n      return JSON.stringify(data, null, 2);\r\n    } catch (error) {\r\n      console.error('Error exporting data:', error);\r\n      return null;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Import data from JSON backup\r\n   * @param {string} jsonString - JSON data string\r\n   * @returns {Object|null} Parsed data or null if invalid\r\n   */\r\n  importData(jsonString) {\r\n    try {\r\n      const data = JSON.parse(jsonString);\r\n      // Validate data structure\r\n      if (data && typeof data === 'object' && \r\n          Array.isArray(data.clients) && \r\n          Array.isArray(data.tasks) && \r\n          Array.isArray(data.entries)) {\r\n        return data;\r\n      }\r\n      return null;\r\n    } catch (error) {\r\n      console.error('Error importing data:', error);\r\n      return null;\r\n    }\r\n  }\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}