{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\jurgl\\\\HTMLProjects\\\\CrickTime\\\\src\\\\components\\\\tabs\\\\InvoiceTab.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useMemo } from 'react';\nimport Card from '../ui/Card';\nimport Button from '../ui/Button';\nimport Input from '../ui/Input';\nimport Select from '../ui/Select';\nimport { dataService } from '../../utils/dataService';\n\n/**\r\n * Invoice Tab Component\r\n * Reference: www.context7.com for invoice generation patterns\r\n */\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst InvoiceTab = ({\n  appData,\n  updateAppData,\n  invoiceContext,\n  clearInvoiceContext\n}) => {\n  _s();\n  const [selectedClient, setSelectedClient] = useState('');\n  const [startDate, setStartDate] = useState('');\n  const [endDate, setEndDate] = useState('');\n  const [invoiceData, setInvoiceData] = useState(null); // holds draft or finalized invoice meta & all candidate line items\n  const [selectedIds, setSelectedIds] = useState(new Set());\n  const [finalized, setFinalized] = useState(false);\n  const [mode, setMode] = useState(invoiceContext !== null && invoiceContext !== void 0 && invoiceContext.jobId ? 'job' : 'client'); // 'client' | 'job'\n  const [selectedJobId, setSelectedJobId] = useState((invoiceContext === null || invoiceContext === void 0 ? void 0 : invoiceContext.jobId) || '');\n  const [closeJobOnFinalize, setCloseJobOnFinalize] = useState(false);\n\n  // Get client options\n  const clientOptions = appData.clients.map(client => ({\n    value: client.id,\n    label: client.name\n  }));\n\n  // Generate draft invoice data (does NOT mark entries invoiced yet)\n  const generateInvoice = () => {\n    if (!selectedClient || !startDate || !endDate) {\n      alert('Please select a client and date range');\n      return;\n    }\n    if (mode === 'job' && !selectedJobId) {\n      alert('Select a job for Job mode');\n      return;\n    }\n    const client = appData.clients.find(c => c.id === selectedClient);\n    if (!client) {\n      alert('Selected client not found');\n      return;\n    }\n    const start = new Date(startDate);\n    const end = new Date(endDate);\n    end.setHours(23, 59, 59, 999); // Include full end date\n\n    if (start > end) {\n      alert('Start date must be before end date');\n      return;\n    }\n\n    // Get entries for the client and date range\n    const clientEntries = appData.entries.filter(entry => {\n      if (!entry.end || entry.clientId !== selectedClient) return false;\n      if (entry.invoiced) return false; // skip already invoiced\n      if (mode === 'job' && entry.jobId !== selectedJobId) return false;\n      const entryDate = new Date(entry.start);\n      return entryDate >= start && entryDate <= end;\n    });\n    if (clientEntries.length === 0) {\n      alert('No entries found for the selected client and date range');\n      return;\n    }\n\n    // Create candidate line items (all initially selected)\n    const lineItems = clientEntries.map(entry => {\n      const taskName = entry.taskName || 'Unknown Task';\n      const duration = entry.end - entry.start;\n      const hours = dataService.durationToHours(duration);\n      const amount = hours * client.rate;\n      return {\n        id: entry.id,\n        date: dataService.formatDate(entry.start),\n        task: taskName,\n        notes: entry.notes || '',\n        hours: hours,\n        rate: client.rate,\n        amount: amount\n      };\n    });\n    const jobMeta = mode === 'job' ? (appData.jobs || []).find(j => j.id === selectedJobId) : null;\n    const invoice = {\n      client,\n      dateRange: {\n        start: dataService.formatDate(start),\n        end: dataService.formatDate(end)\n      },\n      lineItems,\n      job: jobMeta ? {\n        id: jobMeta.id,\n        name: jobMeta.name\n      } : null,\n      generatedDate: dataService.formatDate(new Date()),\n      invoiceNumber: `INV-${Date.now()}`\n    };\n    setInvoiceData(invoice);\n    setSelectedIds(new Set(lineItems.map(li => li.id)));\n    setFinalized(false);\n  };\n\n  // Toggle selection of a line item\n  const toggleLineItem = id => {\n    if (finalized) return;\n    setSelectedIds(prev => {\n      const next = new Set(prev);\n      if (next.has(id)) next.delete(id);else next.add(id);\n      return next;\n    });\n  };\n  const selectAll = () => {\n    if (!invoiceData || finalized) return;\n    setSelectedIds(new Set(invoiceData.lineItems.map(li => li.id)));\n  };\n  const clearAll = () => {\n    if (finalized) return;\n    setSelectedIds(new Set());\n  };\n\n  // Compute totals from selected items\n  const selectedLineItems = useMemo(() => {\n    if (!invoiceData) return [];\n    return invoiceData.lineItems.filter(li => selectedIds.has(li.id));\n  }, [invoiceData, selectedIds]);\n  const computedTotals = useMemo(() => {\n    const hours = selectedLineItems.reduce((s, i) => s + i.hours, 0);\n    const amount = selectedLineItems.reduce((s, i) => s + i.amount, 0);\n    return {\n      hours,\n      amount\n    };\n  }, [selectedLineItems]);\n\n  // Finalize invoice: mark selected entries as invoiced\n  const finalizeInvoice = () => {\n    if (!invoiceData) return;\n    if (selectedIds.size === 0) {\n      alert('Select at least one line item to finalize the invoice.');\n      return;\n    }\n    const updatedEntries = appData.entries.map(e => selectedIds.has(e.id) ? {\n      ...e,\n      invoiced: true\n    } : e);\n    let changes = {\n      entries: updatedEntries\n    };\n    if (closeJobOnFinalize && invoiceData.job) {\n      changes.jobs = (appData.jobs || []).map(j => j.id === invoiceData.job.id ? {\n        ...j,\n        closed: true,\n        closedAt: Date.now()\n      } : j);\n    }\n    updateAppData(changes);\n    setFinalized(true);\n  };\n\n  // Export invoice as CSV\n  const exportCSV = () => {\n    if (!invoiceData) return;\n    const headers = ['Date', 'Task', 'Notes', 'Hours', 'Rate', 'Amount'];\n    const rows = selectedLineItems.map(item => [item.date, item.task, item.notes, item.hours.toFixed(2), item.rate.toFixed(2), item.amount.toFixed(2)]);\n\n    // Add totals row\n    rows.push(['', '', 'TOTAL', computedTotals.hours.toFixed(2), '', computedTotals.amount.toFixed(2)]);\n    const csvContent = [headers, ...rows].map(row => row.map(cell => `\"${cell}\"`).join(',')).join('\\n');\n    const blob = new Blob([csvContent], {\n      type: 'text/csv'\n    });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `invoice-${invoiceData.client.name}-${invoiceData.dateRange.start}-to-${invoiceData.dateRange.end}.csv`;\n    link.click();\n    URL.revokeObjectURL(url);\n  };\n\n  // Print invoice\n  const printInvoice = () => {\n    if (!invoiceData) return;\n    const printWindow = window.open('', '_blank');\n    const printContent = generatePrintHTML({\n      ...invoiceData,\n      lineItems: selectedLineItems,\n      totals: computedTotals\n    });\n    printWindow.document.write(printContent);\n    printWindow.document.close();\n    printWindow.focus();\n    printWindow.print();\n  };\n\n  // Generate HTML for printing\n  const generatePrintHTML = invoice => {\n    return `\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Invoice - ${invoice.client.name}</title>\n    <style>\n        body { font-family: Arial, sans-serif; margin: 40px; color: #333; }\n        .header { text-align: center; margin-bottom: 40px; }\n        .invoice-title { font-size: 28px; font-weight: bold; color: #2563eb; }\n        .invoice-info { display: flex; justify-content: space-between; margin-bottom: 30px; }\n        .client-info h3, .invoice-details h3 { margin-top: 0; color: #374151; }\n        table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }\n        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #e5e7eb; }\n        th { background-color: #f9fafb; font-weight: bold; }\n        .amount { text-align: right; }\n        .totals { font-weight: bold; background-color: #f3f4f6; }\n        .footer { margin-top: 40px; text-align: center; color: #6b7280; font-size: 14px; }\n        @media print {\n            body { margin: 20px; }\n            .no-print { display: none; }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <div class=\"invoice-title\">INVOICE</div>\n        <div style=\"margin-top: 10px; color: #6b7280;\">Mechanic Hours Time Tracking</div>\n    </div>\n    \n    <div class=\"invoice-info\">\n        <div class=\"client-info\">\n            <h3>Bill To:</h3>\n            <div><strong>${invoice.client.name}</strong></div>\n            ${invoice.client.contact ? `<div>${invoice.client.contact}</div>` : ''}\n        </div>\n        \n        <div class=\"invoice-details\">\n            <h3>Invoice Details:</h3>\n            <div><strong>Invoice #:</strong> ${invoice.invoiceNumber}</div>\n            <div><strong>Date:</strong> ${invoice.generatedDate}</div>\n            <div><strong>Period:</strong> ${invoice.dateRange.start} - ${invoice.dateRange.end}</div>\n        </div>\n    </div>\n    \n    <table>\n        <thead>\n            <tr>\n                <th>Date</th>\n                <th>Task</th>\n                <th>Notes</th>\n                <th>Hours</th>\n                <th>Rate</th>\n                <th class=\"amount\">Amount</th>\n            </tr>\n        </thead>\n        <tbody>\n            ${invoice.lineItems.map(item => `\n                <tr>\n                    <td>${item.date}</td>\n                    <td>${item.task}</td>\n                    <td>${item.notes}</td>\n                    <td>${item.hours.toFixed(2)}</td>\n                    <td>${dataService.formatCurrency(item.rate)}</td>\n                    <td class=\"amount\">${dataService.formatCurrency(item.amount)}</td>\n                </tr>\n            `).join('')}\n      <tr class=\"totals\">\n        <td colspan=\"3\">TOTAL</td>\n        <td><strong>${invoice.totals.hours.toFixed(2)}</strong></td>\n        <td></td>\n        <td class=\"amount\"><strong>${dataService.formatCurrency(invoice.totals.amount)}</strong></td>\n      </tr>\n        </tbody>\n    </table>\n    \n    <div class=\"footer\">\n        <p>Generated by Mechanic Hours - www.context7.com</p>\n        <p>Thank you for your business!</p>\n    </div>\n</body>\n</html>\n    `;\n  };\n\n  // Clear invoice\n  const clearInvoice = () => {\n    setInvoiceData(null);\n    setSelectedClient('');\n    setStartDate('');\n    setEndDate('');\n    setSelectedIds(new Set());\n    setFinalized(false);\n    setSelectedJobId('');\n    setMode('client');\n    setCloseJobOnFinalize(false);\n    clearInvoiceContext && clearInvoiceContext();\n  };\n\n  // Set quick date ranges\n  const setThisWeek = () => {\n    const now = new Date();\n    const startOfWeek = new Date(now);\n    startOfWeek.setDate(now.getDate() - now.getDay()); // Start of week (Sunday)\n\n    setStartDate(startOfWeek.toISOString().slice(0, 10));\n    setEndDate(now.toISOString().slice(0, 10));\n  };\n  const setThisMonth = () => {\n    const now = new Date();\n    const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);\n    setStartDate(startOfMonth.toISOString().slice(0, 10));\n    setEndDate(now.toISOString().slice(0, 10));\n  };\n  const setLastMonth = () => {\n    const now = new Date();\n    const startOfLastMonth = new Date(now.getFullYear(), now.getMonth() - 1, 1);\n    const endOfLastMonth = new Date(now.getFullYear(), now.getMonth(), 0);\n    setStartDate(startOfLastMonth.toISOString().slice(0, 10));\n    setEndDate(endOfLastMonth.toISOString().slice(0, 10));\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: [!invoiceData ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Card, {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl font-bold mb-4\",\n          children: \"Generate Invoice\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 333,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex gap-2 mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            size: \"small\",\n            variant: mode === 'client' ? 'primary' : 'secondary',\n            onClick: () => setMode('client'),\n            children: \"By Client\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 336,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            size: \"small\",\n            variant: mode === 'job' ? 'primary' : 'secondary',\n            onClick: () => setMode('job'),\n            children: \"By Job\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 337,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 335,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Select, {\n          label: \"Client\",\n          value: selectedClient,\n          onChange: e => {\n            setSelectedClient(e.target.value);\n            if (mode === 'job') setSelectedJobId('');\n          },\n          options: clientOptions,\n          placeholder: \"Select a client\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 13\n        }, this), mode === 'job' && selectedClient && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"input-label\",\n            children: \"Job\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            className: \"select\",\n            value: selectedJobId,\n            onChange: e => setSelectedJobId(e.target.value),\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"-- Select Job --\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 356,\n              columnNumber: 19\n            }, this), (appData.jobs || []).filter(j => !j.closed).filter(j => (appData.entries || []).some(e => e.jobId === j.id && e.clientId === selectedClient && e.end && !e.invoiced)).sort((a, b) => a.name.localeCompare(b.name)).map(j => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: j.id,\n              children: j.name\n            }, j.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 31\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 351,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 349,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 md:grid-cols-2 gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(Input, {\n            label: \"Start Date\",\n            type: \"date\",\n            value: startDate,\n            onChange: e => setStartDate(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            label: \"End Date\",\n            type: \"date\",\n            value: endDate,\n            onChange: e => setEndDate(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-wrap gap-2 mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            variant: \"secondary\",\n            size: \"small\",\n            onClick: setThisWeek,\n            children: \"This Week\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 384,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"secondary\",\n            size: \"small\",\n            onClick: setThisMonth,\n            children: \"This Month\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 387,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"secondary\",\n            size: \"small\",\n            onClick: setLastMonth,\n            children: \"Last Month\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 383,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: generateInvoice,\n          className: \"w-full\",\n          disabled: !selectedClient || !startDate || !endDate || mode === 'job' && !selectedJobId,\n          children: [\"\\uD83D\\uDCC4 Generate \", mode === 'job' ? 'Job' : 'Client', \" Invoice\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 395,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 11\n      }, this), appData.clients.length > 0 && /*#__PURE__*/_jsxDEV(Card, {\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold mb-4\",\n          children: \"Quick Stats\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 407,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 md:grid-cols-3 gap-4 text-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-2xl font-bold text-primary-600\",\n              children: appData.clients.length\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 410,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-600\",\n              children: \"Active Clients\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 413,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 409,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-2xl font-bold text-green-600\",\n              children: appData.entries.filter(e => e.end).length\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 416,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-600\",\n              children: \"Completed Entries\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 419,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 415,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-2xl font-bold text-blue-600\",\n              children: [dataService.calculateTotalHours(appData.entries.filter(e => e.end)).toFixed(1), \"h\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 422,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-600\",\n              children: \"Total Hours\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 425,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 421,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 408,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 406,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(Card, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-start mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"text-xl font-bold\",\n              children: \"Invoice\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 436,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-500\",\n              children: [invoiceData.invoiceNumber, !finalized && ' (Draft)', \" \", invoiceData.job && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ml-1 px-1 rounded bg-blue-600 text-white text-xs\",\n                children: [\"Job: \", invoiceData.job.name]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 437,\n                columnNumber: 128\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 437,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xs text-gray-500\",\n              children: [invoiceData.dateRange.start, \" - \", invoiceData.dateRange.end]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 438,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 435,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"secondary\",\n            size: \"small\",\n            onClick: clearInvoice,\n            children: \"Back\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 440,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 434,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"font-semibold\",\n            children: invoiceData.client.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 443,\n            columnNumber: 15\n          }, this), invoiceData.client.contact && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-gray-400\",\n            children: invoiceData.client.contact\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 444,\n            columnNumber: 46\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 442,\n          columnNumber: 13\n        }, this), !finalized && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-wrap gap-2 mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            size: \"small\",\n            variant: \"secondary\",\n            onClick: selectAll,\n            children: \"Select All\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 449,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            size: \"small\",\n            variant: \"secondary\",\n            onClick: clearAll,\n            children: \"Clear All\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 450,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            size: \"small\",\n            onClick: finalizeInvoice,\n            disabled: selectedIds.size === 0,\n            children: \"Finalize & Mark Invoiced\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 451,\n            columnNumber: 17\n          }, this), invoiceData.job && /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"flex items-center gap-1 text-xs text-gray-400 ml-auto\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              checked: closeJobOnFinalize,\n              onChange: () => setCloseJobOnFinalize(v => !v)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 454,\n              columnNumber: 21\n            }, this), \" Close Job\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 453,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 448,\n          columnNumber: 15\n        }, this), finalized && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-2 text-xs text-green-600 font-medium\",\n          children: [\"Finalized \\u2022 \", selectedIds.size, \" items marked invoiced\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 461,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"activity-list\",\n          children: invoiceData.lineItems.map(item => {\n            const checked = selectedIds.has(item.id);\n            const disabled = finalized;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `individual-job-card ${!checked ? 'opacity-50' : ''}`,\n              style: {\n                position: 'relative'\n              },\n              children: [!finalized && /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"checkbox\",\n                checked: checked,\n                onChange: () => toggleLineItem(item.id),\n                style: {\n                  position: 'absolute',\n                  top: 6,\n                  left: 6,\n                  width: 16,\n                  height: 16\n                },\n                disabled: disabled,\n                title: \"Include in invoice\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 470,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"job-card-content\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"job-main-info\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"job-title\",\n                    children: item.task\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 481,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"job-time\",\n                    children: [item.date, \" \\u2022 \", item.hours.toFixed(2), \"h @ \", dataService.formatCurrency(item.rate)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 482,\n                    columnNumber: 23\n                  }, this), item.notes && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"job-notes\",\n                    children: item.notes\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 483,\n                    columnNumber: 38\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 480,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"job-actions\",\n                  style: {\n                    alignItems: 'flex-end'\n                  },\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"stat-value stat-value-success\",\n                    style: {\n                      fontSize: '0.85rem'\n                    },\n                    children: dataService.formatCurrency(item.amount)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 486,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 485,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 479,\n                columnNumber: 19\n              }, this)]\n            }, item.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 468,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 463,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"separator\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 492,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between text-sm font-semibold\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Total Hours\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 494,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [computedTotals.hours.toFixed(2), \"h\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 495,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 493,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between text-sm font-semibold mt-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Total Amount\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 498,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: dataService.formatCurrency(computedTotals.amount)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 499,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 497,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex gap-2 mt-4\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            onClick: printInvoice,\n            className: \"flex-1\",\n            size: \"small\",\n            children: \"Print\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 502,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"secondary\",\n            onClick: exportCSV,\n            className: \"flex-1\",\n            size: \"small\",\n            children: \"CSV\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 503,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 501,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 433,\n        columnNumber: 11\n      }, this)\n    }, void 0, false), appData.entries.filter(e => e.end).length === 0 && /*#__PURE__*/_jsxDEV(Card, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center py-6 text-gray-600\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mb-2\",\n          children: \"No completed time entries found.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 513,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Start tracking time to generate invoices!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 514,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 512,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 511,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 328,\n    columnNumber: 5\n  }, this);\n};\n_s(InvoiceTab, \"nvsceRoGGKz7dc30dftme7W/CTo=\");\n_c = InvoiceTab;\nexport default InvoiceTab;\nvar _c;\n$RefreshReg$(_c, \"InvoiceTab\");","map":{"version":3,"names":["React","useState","useMemo","Card","Button","Input","Select","dataService","jsxDEV","_jsxDEV","Fragment","_Fragment","InvoiceTab","appData","updateAppData","invoiceContext","clearInvoiceContext","_s","selectedClient","setSelectedClient","startDate","setStartDate","endDate","setEndDate","invoiceData","setInvoiceData","selectedIds","setSelectedIds","Set","finalized","setFinalized","mode","setMode","jobId","selectedJobId","setSelectedJobId","closeJobOnFinalize","setCloseJobOnFinalize","clientOptions","clients","map","client","value","id","label","name","generateInvoice","alert","find","c","start","Date","end","setHours","clientEntries","entries","filter","entry","clientId","invoiced","entryDate","length","lineItems","taskName","duration","hours","durationToHours","amount","rate","date","formatDate","task","notes","jobMeta","jobs","j","invoice","dateRange","job","generatedDate","invoiceNumber","now","li","toggleLineItem","prev","next","has","delete","add","selectAll","clearAll","selectedLineItems","computedTotals","reduce","s","i","finalizeInvoice","size","updatedEntries","e","changes","closed","closedAt","exportCSV","headers","rows","item","toFixed","push","csvContent","row","cell","join","blob","Blob","type","url","URL","createObjectURL","link","document","createElement","href","download","click","revokeObjectURL","printInvoice","printWindow","window","open","printContent","generatePrintHTML","totals","write","close","focus","print","contact","formatCurrency","clearInvoice","setThisWeek","startOfWeek","setDate","getDate","getDay","toISOString","slice","setThisMonth","startOfMonth","getFullYear","getMonth","setLastMonth","startOfLastMonth","endOfLastMonth","className","children","fileName","_jsxFileName","lineNumber","columnNumber","variant","onClick","onChange","target","options","placeholder","some","sort","a","b","localeCompare","disabled","calculateTotalHours","checked","v","style","position","top","left","width","height","title","alignItems","fontSize","_c","$RefreshReg$"],"sources":["C:/Users/jurgl/HTMLProjects/CrickTime/src/components/tabs/InvoiceTab.js"],"sourcesContent":["import React, { useState, useMemo } from 'react';\r\nimport Card from '../ui/Card';\r\nimport Button from '../ui/Button';\r\nimport Input from '../ui/Input';\r\nimport Select from '../ui/Select';\r\nimport { dataService } from '../../utils/dataService';\r\n\r\n/**\r\n * Invoice Tab Component\r\n * Reference: www.context7.com for invoice generation patterns\r\n */\r\nconst InvoiceTab = ({ appData, updateAppData, invoiceContext, clearInvoiceContext }) => {\r\n  const [selectedClient, setSelectedClient] = useState('');\r\n  const [startDate, setStartDate] = useState('');\r\n  const [endDate, setEndDate] = useState('');\r\n  const [invoiceData, setInvoiceData] = useState(null); // holds draft or finalized invoice meta & all candidate line items\r\n  const [selectedIds, setSelectedIds] = useState(new Set());\r\n  const [finalized, setFinalized] = useState(false);\r\n  const [mode, setMode] = useState(invoiceContext?.jobId ? 'job' : 'client'); // 'client' | 'job'\r\n  const [selectedJobId, setSelectedJobId] = useState(invoiceContext?.jobId || '');\r\n  const [closeJobOnFinalize, setCloseJobOnFinalize] = useState(false);\r\n\r\n  // Get client options\r\n  const clientOptions = appData.clients.map(client => ({\r\n    value: client.id,\r\n    label: client.name\r\n  }));\r\n\r\n  // Generate draft invoice data (does NOT mark entries invoiced yet)\r\n  const generateInvoice = () => {\r\n    if (!selectedClient || !startDate || !endDate) {\r\n      alert('Please select a client and date range');\r\n      return;\r\n    }\r\n\r\n    if (mode === 'job' && !selectedJobId) {\r\n      alert('Select a job for Job mode');\r\n      return;\r\n    }\r\n\r\n    const client = appData.clients.find(c => c.id === selectedClient);\r\n    if (!client) {\r\n      alert('Selected client not found');\r\n      return;\r\n    }\r\n\r\n    const start = new Date(startDate);\r\n    const end = new Date(endDate);\r\n    end.setHours(23, 59, 59, 999); // Include full end date\r\n\r\n    if (start > end) {\r\n      alert('Start date must be before end date');\r\n      return;\r\n    }\r\n\r\n    // Get entries for the client and date range\r\n    const clientEntries = appData.entries.filter(entry => {\r\n      if (!entry.end || entry.clientId !== selectedClient) return false;\r\n      if (entry.invoiced) return false; // skip already invoiced\r\n      if (mode === 'job' && entry.jobId !== selectedJobId) return false;\r\n      \r\n      const entryDate = new Date(entry.start);\r\n      return entryDate >= start && entryDate <= end;\r\n    });\r\n\r\n    if (clientEntries.length === 0) {\r\n      alert('No entries found for the selected client and date range');\r\n      return;\r\n    }\r\n\r\n  // Create candidate line items (all initially selected)\r\n  const lineItems = clientEntries.map(entry => {\r\n      const taskName = entry.taskName || 'Unknown Task';\r\n      const duration = entry.end - entry.start;\r\n      const hours = dataService.durationToHours(duration);\r\n      const amount = hours * client.rate;\r\n\r\n      return {\r\n        id: entry.id,\r\n        date: dataService.formatDate(entry.start),\r\n        task: taskName,\r\n        notes: entry.notes || '',\r\n        hours: hours,\r\n        rate: client.rate,\r\n        amount: amount\r\n      };\r\n    });\r\n\r\n    const jobMeta = mode === 'job' ? (appData.jobs || []).find(j => j.id === selectedJobId) : null;\r\n    const invoice = {\r\n      client,\r\n      dateRange: {\r\n        start: dataService.formatDate(start),\r\n        end: dataService.formatDate(end)\r\n      },\r\n      lineItems,\r\n      job: jobMeta ? { id: jobMeta.id, name: jobMeta.name } : null,\r\n      generatedDate: dataService.formatDate(new Date()),\r\n      invoiceNumber: `INV-${Date.now()}`\r\n    };\r\n\r\n    setInvoiceData(invoice);\r\n    setSelectedIds(new Set(lineItems.map(li => li.id)));\r\n    setFinalized(false);\r\n  };\r\n\r\n  // Toggle selection of a line item\r\n  const toggleLineItem = (id) => {\r\n    if (finalized) return;\r\n    setSelectedIds(prev => {\r\n      const next = new Set(prev);\r\n      if (next.has(id)) next.delete(id); else next.add(id);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const selectAll = () => {\r\n    if (!invoiceData || finalized) return;\r\n    setSelectedIds(new Set(invoiceData.lineItems.map(li => li.id)));\r\n  };\r\n\r\n  const clearAll = () => {\r\n    if (finalized) return;\r\n    setSelectedIds(new Set());\r\n  };\r\n\r\n  // Compute totals from selected items\r\n  const selectedLineItems = useMemo(() => {\r\n    if (!invoiceData) return [];\r\n    return invoiceData.lineItems.filter(li => selectedIds.has(li.id));\r\n  }, [invoiceData, selectedIds]);\r\n\r\n  const computedTotals = useMemo(() => {\r\n    const hours = selectedLineItems.reduce((s, i) => s + i.hours, 0);\r\n    const amount = selectedLineItems.reduce((s, i) => s + i.amount, 0);\r\n    return { hours, amount };\r\n  }, [selectedLineItems]);\r\n\r\n  // Finalize invoice: mark selected entries as invoiced\r\n  const finalizeInvoice = () => {\r\n    if (!invoiceData) return;\r\n    if (selectedIds.size === 0) {\r\n      alert('Select at least one line item to finalize the invoice.');\r\n      return;\r\n    }\r\n    const updatedEntries = appData.entries.map(e =>\r\n      selectedIds.has(e.id) ? { ...e, invoiced: true } : e\r\n    );\r\n    let changes = { entries: updatedEntries };\r\n    if (closeJobOnFinalize && invoiceData.job) {\r\n      changes.jobs = (appData.jobs || []).map(j => j.id === invoiceData.job.id ? { ...j, closed: true, closedAt: Date.now() } : j);\r\n    }\r\n    updateAppData(changes);\r\n    setFinalized(true);\r\n  };\r\n\r\n  // Export invoice as CSV\r\n  const exportCSV = () => {\r\n    if (!invoiceData) return;\r\n\r\n    const headers = ['Date', 'Task', 'Notes', 'Hours', 'Rate', 'Amount'];\r\n    const rows = selectedLineItems.map(item => [\r\n      item.date,\r\n      item.task,\r\n      item.notes,\r\n      item.hours.toFixed(2),\r\n      item.rate.toFixed(2),\r\n      item.amount.toFixed(2)\r\n    ]);\r\n\r\n    // Add totals row\r\n    rows.push(['', '', 'TOTAL', computedTotals.hours.toFixed(2), '', computedTotals.amount.toFixed(2)]);\r\n\r\n    const csvContent = [headers, ...rows]\r\n      .map(row => row.map(cell => `\"${cell}\"`).join(','))\r\n      .join('\\n');\r\n\r\n    const blob = new Blob([csvContent], { type: 'text/csv' });\r\n    const url = URL.createObjectURL(blob);\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    link.download = `invoice-${invoiceData.client.name}-${invoiceData.dateRange.start}-to-${invoiceData.dateRange.end}.csv`;\r\n    link.click();\r\n    URL.revokeObjectURL(url);\r\n  };\r\n\r\n  // Print invoice\r\n  const printInvoice = () => {\r\n    if (!invoiceData) return;\r\n\r\n    const printWindow = window.open('', '_blank');\r\n    const printContent = generatePrintHTML({ ...invoiceData, lineItems: selectedLineItems, totals: computedTotals });\r\n    \r\n    printWindow.document.write(printContent);\r\n    printWindow.document.close();\r\n    printWindow.focus();\r\n    printWindow.print();\r\n  };\r\n\r\n  // Generate HTML for printing\r\n  const generatePrintHTML = (invoice) => {\r\n    return `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n    <title>Invoice - ${invoice.client.name}</title>\r\n    <style>\r\n        body { font-family: Arial, sans-serif; margin: 40px; color: #333; }\r\n        .header { text-align: center; margin-bottom: 40px; }\r\n        .invoice-title { font-size: 28px; font-weight: bold; color: #2563eb; }\r\n        .invoice-info { display: flex; justify-content: space-between; margin-bottom: 30px; }\r\n        .client-info h3, .invoice-details h3 { margin-top: 0; color: #374151; }\r\n        table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }\r\n        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #e5e7eb; }\r\n        th { background-color: #f9fafb; font-weight: bold; }\r\n        .amount { text-align: right; }\r\n        .totals { font-weight: bold; background-color: #f3f4f6; }\r\n        .footer { margin-top: 40px; text-align: center; color: #6b7280; font-size: 14px; }\r\n        @media print {\r\n            body { margin: 20px; }\r\n            .no-print { display: none; }\r\n        }\r\n    </style>\r\n</head>\r\n<body>\r\n    <div class=\"header\">\r\n        <div class=\"invoice-title\">INVOICE</div>\r\n        <div style=\"margin-top: 10px; color: #6b7280;\">Mechanic Hours Time Tracking</div>\r\n    </div>\r\n    \r\n    <div class=\"invoice-info\">\r\n        <div class=\"client-info\">\r\n            <h3>Bill To:</h3>\r\n            <div><strong>${invoice.client.name}</strong></div>\r\n            ${invoice.client.contact ? `<div>${invoice.client.contact}</div>` : ''}\r\n        </div>\r\n        \r\n        <div class=\"invoice-details\">\r\n            <h3>Invoice Details:</h3>\r\n            <div><strong>Invoice #:</strong> ${invoice.invoiceNumber}</div>\r\n            <div><strong>Date:</strong> ${invoice.generatedDate}</div>\r\n            <div><strong>Period:</strong> ${invoice.dateRange.start} - ${invoice.dateRange.end}</div>\r\n        </div>\r\n    </div>\r\n    \r\n    <table>\r\n        <thead>\r\n            <tr>\r\n                <th>Date</th>\r\n                <th>Task</th>\r\n                <th>Notes</th>\r\n                <th>Hours</th>\r\n                <th>Rate</th>\r\n                <th class=\"amount\">Amount</th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            ${invoice.lineItems.map(item => `\r\n                <tr>\r\n                    <td>${item.date}</td>\r\n                    <td>${item.task}</td>\r\n                    <td>${item.notes}</td>\r\n                    <td>${item.hours.toFixed(2)}</td>\r\n                    <td>${dataService.formatCurrency(item.rate)}</td>\r\n                    <td class=\"amount\">${dataService.formatCurrency(item.amount)}</td>\r\n                </tr>\r\n            `).join('')}\r\n      <tr class=\"totals\">\r\n        <td colspan=\"3\">TOTAL</td>\r\n        <td><strong>${invoice.totals.hours.toFixed(2)}</strong></td>\r\n        <td></td>\r\n        <td class=\"amount\"><strong>${dataService.formatCurrency(invoice.totals.amount)}</strong></td>\r\n      </tr>\r\n        </tbody>\r\n    </table>\r\n    \r\n    <div class=\"footer\">\r\n        <p>Generated by Mechanic Hours - www.context7.com</p>\r\n        <p>Thank you for your business!</p>\r\n    </div>\r\n</body>\r\n</html>\r\n    `;\r\n  };\r\n\r\n  // Clear invoice\r\n  const clearInvoice = () => {\r\n    setInvoiceData(null);\r\n    setSelectedClient('');\r\n    setStartDate('');\r\n    setEndDate('');\r\n    setSelectedIds(new Set());\r\n    setFinalized(false);\r\n    setSelectedJobId('');\r\n    setMode('client');\r\n    setCloseJobOnFinalize(false);\r\n    clearInvoiceContext && clearInvoiceContext();\r\n  };\r\n\r\n  // Set quick date ranges\r\n  const setThisWeek = () => {\r\n    const now = new Date();\r\n    const startOfWeek = new Date(now);\r\n    startOfWeek.setDate(now.getDate() - now.getDay()); // Start of week (Sunday)\r\n    \r\n    setStartDate(startOfWeek.toISOString().slice(0, 10));\r\n    setEndDate(now.toISOString().slice(0, 10));\r\n  };\r\n\r\n  const setThisMonth = () => {\r\n    const now = new Date();\r\n    const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);\r\n    \r\n    setStartDate(startOfMonth.toISOString().slice(0, 10));\r\n    setEndDate(now.toISOString().slice(0, 10));\r\n  };\r\n\r\n  const setLastMonth = () => {\r\n    const now = new Date();\r\n    const startOfLastMonth = new Date(now.getFullYear(), now.getMonth() - 1, 1);\r\n    const endOfLastMonth = new Date(now.getFullYear(), now.getMonth(), 0);\r\n    \r\n    setStartDate(startOfLastMonth.toISOString().slice(0, 10));\r\n    setEndDate(endOfLastMonth.toISOString().slice(0, 10));\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {!invoiceData ? (\r\n        <>\r\n          {/* Invoice Generation Form */}\r\n          <Card>\r\n            <h2 className=\"text-xl font-bold mb-4\">Generate Invoice</h2>\r\n\r\n            <div className=\"flex gap-2 mb-3\">\r\n              <Button size=\"small\" variant={mode==='client'?'primary':'secondary'} onClick={()=>setMode('client')}>By Client</Button>\r\n              <Button size=\"small\" variant={mode==='job'?'primary':'secondary'} onClick={()=>setMode('job')}>By Job</Button>\r\n            </div>\r\n            \r\n            <Select\r\n              label=\"Client\"\r\n              value={selectedClient}\r\n              onChange={(e) => { setSelectedClient(e.target.value); if(mode==='job') setSelectedJobId(''); }}\r\n              options={clientOptions}\r\n              placeholder=\"Select a client\"\r\n            />\r\n\r\n            {mode === 'job' && selectedClient && (\r\n              <div className=\"mb-3\">\r\n                <label className=\"input-label\">Job</label>\r\n                <select\r\n                  className=\"select\"\r\n                  value={selectedJobId}\r\n                  onChange={(e)=>setSelectedJobId(e.target.value)}\r\n                >\r\n                  <option value=\"\">-- Select Job --</option>\r\n                  {(appData.jobs||[])\r\n                    .filter(j=>!j.closed)\r\n                    .filter(j=> (appData.entries||[]).some(e=>e.jobId===j.id && e.clientId===selectedClient && e.end && !e.invoiced))\r\n                    .sort((a,b)=>a.name.localeCompare(b.name))\r\n                    .map(j => <option key={j.id} value={j.id}>{j.name}</option>)}\r\n                </select>\r\n              </div>\r\n            )}\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n              <Input\r\n                label=\"Start Date\"\r\n                type=\"date\"\r\n                value={startDate}\r\n                onChange={(e) => setStartDate(e.target.value)}\r\n              />\r\n              \r\n              <Input\r\n                label=\"End Date\"\r\n                type=\"date\"\r\n                value={endDate}\r\n                onChange={(e) => setEndDate(e.target.value)}\r\n              />\r\n            </div>\r\n            \r\n            {/* Quick Date Buttons */}\r\n            <div className=\"flex flex-wrap gap-2 mb-4\">\r\n              <Button variant=\"secondary\" size=\"small\" onClick={setThisWeek}>\r\n                This Week\r\n              </Button>\r\n              <Button variant=\"secondary\" size=\"small\" onClick={setThisMonth}>\r\n                This Month\r\n              </Button>\r\n              <Button variant=\"secondary\" size=\"small\" onClick={setLastMonth}>\r\n                Last Month\r\n              </Button>\r\n            </div>\r\n            \r\n            <Button \r\n              onClick={generateInvoice}\r\n              className=\"w-full\"\r\n              disabled={!selectedClient || !startDate || !endDate || (mode==='job' && !selectedJobId)}\r\n            >\r\n               Generate {mode==='job' ? 'Job' : 'Client'} Invoice\r\n            </Button>\r\n          </Card>\r\n\r\n          {/* Summary Statistics */}\r\n          {appData.clients.length > 0 && (\r\n            <Card>\r\n              <h3 className=\"text-lg font-semibold mb-4\">Quick Stats</h3>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-center\">\r\n                <div>\r\n                  <div className=\"text-2xl font-bold text-primary-600\">\r\n                    {appData.clients.length}\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-600\">Active Clients</div>\r\n                </div>\r\n                <div>\r\n                  <div className=\"text-2xl font-bold text-green-600\">\r\n                    {appData.entries.filter(e => e.end).length}\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-600\">Completed Entries</div>\r\n                </div>\r\n                <div>\r\n                  <div className=\"text-2xl font-bold text-blue-600\">\r\n                    {dataService.calculateTotalHours(appData.entries.filter(e => e.end)).toFixed(1)}h\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-600\">Total Hours</div>\r\n                </div>\r\n              </div>\r\n            </Card>\r\n          )}\r\n        </>\r\n      ) : (\r\n        <>\r\n          <Card>\r\n            <div className=\"flex justify-between items-start mb-4\">\r\n              <div>\r\n                <h2 className=\"text-xl font-bold\">Invoice</h2>\r\n                <p className=\"text-sm text-gray-500\">{invoiceData.invoiceNumber}{!finalized && ' (Draft)'} {invoiceData.job && <span className=\"ml-1 px-1 rounded bg-blue-600 text-white text-xs\">Job: {invoiceData.job.name}</span>}</p>\r\n                <p className=\"text-xs text-gray-500\">{invoiceData.dateRange.start} - {invoiceData.dateRange.end}</p>\r\n              </div>\r\n              <Button variant=\"secondary\" size=\"small\" onClick={clearInvoice}>Back</Button>\r\n            </div>\r\n            <div className=\"mb-4\">\r\n              <div className=\"font-semibold\">{invoiceData.client.name}</div>\r\n              {invoiceData.client.contact && <div className=\"text-xs text-gray-400\">{invoiceData.client.contact}</div>}\r\n            </div>\r\n\r\n            {!finalized && (\r\n              <div className=\"flex flex-wrap gap-2 mb-3\">\r\n                <Button size=\"small\" variant=\"secondary\" onClick={selectAll}>Select All</Button>\r\n                <Button size=\"small\" variant=\"secondary\" onClick={clearAll}>Clear All</Button>\r\n                <Button size=\"small\" onClick={finalizeInvoice} disabled={selectedIds.size === 0}>Finalize & Mark Invoiced</Button>\r\n                {invoiceData.job && (\r\n                  <label className=\"flex items-center gap-1 text-xs text-gray-400 ml-auto\">\r\n                    <input type=\"checkbox\" checked={closeJobOnFinalize} onChange={()=>setCloseJobOnFinalize(v=>!v)} /> Close Job\r\n                  </label>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {finalized && (\r\n              <div className=\"mb-2 text-xs text-green-600 font-medium\">Finalized  {selectedIds.size} items marked invoiced</div>\r\n            )}\r\n            <div className=\"activity-list\">\r\n              {invoiceData.lineItems.map(item => {\r\n                const checked = selectedIds.has(item.id);\r\n                const disabled = finalized;\r\n                return (\r\n                <div key={item.id} className={`individual-job-card ${!checked ? 'opacity-50' : ''}`} style={{position:'relative'}}>\r\n                  {!finalized && (\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={checked}\r\n                      onChange={() => toggleLineItem(item.id)}\r\n                      style={{position:'absolute', top:6, left:6, width:16, height:16}}\r\n                      disabled={disabled}\r\n                      title=\"Include in invoice\"\r\n                    />\r\n                  )}\r\n                  <div className=\"job-card-content\">\r\n                    <div className=\"job-main-info\">\r\n                      <div className=\"job-title\">{item.task}</div>\r\n                      <div className=\"job-time\">{item.date}  {item.hours.toFixed(2)}h @ {dataService.formatCurrency(item.rate)}</div>\r\n                      {item.notes && <div className=\"job-notes\">{item.notes}</div>}\r\n                    </div>\r\n                    <div className=\"job-actions\" style={{alignItems:'flex-end'}}>\r\n                      <div className=\"stat-value stat-value-success\" style={{fontSize:'0.85rem'}}>{dataService.formatCurrency(item.amount)}</div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )})}\r\n            </div>\r\n            <div className=\"separator\" />\r\n            <div className=\"flex justify-between text-sm font-semibold\">\r\n              <span>Total Hours</span>\r\n              <span>{computedTotals.hours.toFixed(2)}h</span>\r\n            </div>\r\n            <div className=\"flex justify-between text-sm font-semibold mt-2\">\r\n              <span>Total Amount</span>\r\n              <span>{dataService.formatCurrency(computedTotals.amount)}</span>\r\n            </div>\r\n            <div className=\"flex gap-2 mt-4\">\r\n              <Button onClick={printInvoice} className=\"flex-1\" size=\"small\">Print</Button>\r\n              <Button variant=\"secondary\" onClick={exportCSV} className=\"flex-1\" size=\"small\">CSV</Button>\r\n            </div>\r\n          </Card>\r\n        </>\r\n      )}\r\n      \r\n      {/* Help Text */}\r\n      {appData.entries.filter(e => e.end).length === 0 && (\r\n        <Card>\r\n          <div className=\"text-center py-6 text-gray-600\">\r\n            <p className=\"mb-2\">No completed time entries found.</p>\r\n            <p>Start tracking time to generate invoices!</p>\r\n          </div>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InvoiceTab;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}