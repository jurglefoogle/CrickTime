{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\jurgl\\\\HTMLProjects\\\\CrickTime\\\\src\\\\components\\\\tabs\\\\InvoiceTab.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useMemo } from 'react';\nimport Card from '../ui/Card';\nimport Button from '../ui/Button';\nimport Input from '../ui/Input';\nimport Select from '../ui/Select';\nimport { dataService } from '../../utils/dataService';\n\n/**\r\n * Invoice Tab Component\r\n * Reference: www.context7.com for invoice generation patterns\r\n */\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst InvoiceTab = ({\n  appData,\n  updateAppData,\n  invoiceContext,\n  clearInvoiceContext\n}) => {\n  _s();\n  const [selectedClient, setSelectedClient] = useState('');\n  const [startDate, setStartDate] = useState('');\n  const [endDate, setEndDate] = useState('');\n  const [invoiceData, setInvoiceData] = useState(null); // holds draft or finalized invoice meta & all candidate line items\n  const [selectedIds, setSelectedIds] = useState(new Set());\n  const [finalized, setFinalized] = useState(false);\n  const [mode, setMode] = useState(invoiceContext !== null && invoiceContext !== void 0 && invoiceContext.jobId ? 'job' : 'client'); // 'client' | 'job'\n  const [selectedJobId, setSelectedJobId] = useState((invoiceContext === null || invoiceContext === void 0 ? void 0 : invoiceContext.jobId) || '');\n  const [closeJobOnFinalize, setCloseJobOnFinalize] = useState(false);\n\n  // Get client options\n  const clientOptions = appData.clients.map(client => ({\n    value: client.id,\n    label: client.name\n  }));\n\n  // Generate draft invoice data (does NOT mark entries/charges invoiced yet)\n  const generateInvoice = () => {\n    if (!selectedClient || !startDate || !endDate) {\n      alert('Please select a client and date range');\n      return;\n    }\n    if (mode === 'job' && !selectedJobId) {\n      alert('Select a job for Job mode');\n      return;\n    }\n    const client = appData.clients.find(c => c.id === selectedClient);\n    if (!client) {\n      alert('Selected client not found');\n      return;\n    }\n    const start = dataService.parseLocalDate(startDate) || new Date(startDate);\n    const end = dataService.parseLocalDate(endDate) || new Date(endDate);\n    end.setHours(23, 59, 59, 999); // Include full end date\n\n    if (start > end) {\n      alert('Start date must be before end date');\n      return;\n    }\n\n    // Get entries for the client and date range\n    const clientEntries = appData.entries.filter(entry => {\n      if (!entry.end || entry.clientId !== selectedClient) return false;\n      if (entry.invoiced) return false; // skip already invoiced\n      if (mode === 'job' && entry.jobId !== selectedJobId) return false;\n      const entryDate = new Date(entry.start);\n      return entryDate >= start && entryDate <= end;\n    });\n\n    // Get charges for client within date range\n    const clientCharges = (appData.charges || []).filter(ch => {\n      if (ch.invoiced) return false;\n      if (ch.clientId !== selectedClient) return false;\n      if (mode === 'job' && ch.jobId !== selectedJobId) return false;\n      const chDate = new Date(ch.createdAt);\n      return chDate >= start && chDate <= end;\n    });\n    if (clientEntries.length === 0 && clientCharges.length === 0) {\n      alert('No billable entries or charges found for the selected criteria');\n      return;\n    }\n\n    // Create candidate line items (all initially selected)\n    const timeLineItems = clientEntries.map(entry => {\n      const taskName = entry.taskName || 'Unknown Task';\n      const duration = entry.end - entry.start;\n      const hours = dataService.durationToHours(duration);\n      const amount = hours * client.rate;\n      return {\n        id: entry.id,\n        date: dataService.formatDate(entry.start),\n        task: taskName,\n        notes: entry.notes || '',\n        hours: hours,\n        rate: client.rate,\n        amount: amount\n      };\n    });\n    const chargeLineItems = clientCharges.map(ch => ({\n      id: ch.id,\n      kind: 'charge',\n      chargeType: ch.kind,\n      date: dataService.formatDate(ch.createdAt),\n      task: ch.description,\n      notes: '',\n      hours: 0,\n      rate: ch.unitPrice,\n      quantity: ch.quantity,\n      unitCost: ch.unitCost,\n      amount: ch.amountCached\n    }));\n    const lineItems = [...timeLineItems, ...chargeLineItems];\n    const jobMeta = mode === 'job' ? (appData.jobs || []).find(j => j.id === selectedJobId) : null;\n    const invoice = {\n      client,\n      dateRange: {\n        start: dataService.formatDate(start),\n        end: dataService.formatDate(end)\n      },\n      lineItems,\n      job: jobMeta ? {\n        id: jobMeta.id,\n        name: jobMeta.name\n      } : null,\n      generatedDate: dataService.formatDate(new Date()),\n      invoiceNumber: `INV-${Date.now()}`\n    };\n    setInvoiceData(invoice);\n    setSelectedIds(new Set(lineItems.map(li => li.id)));\n    setFinalized(false);\n  };\n\n  // Toggle selection of a line item\n  const toggleLineItem = id => {\n    if (finalized) return;\n    setSelectedIds(prev => {\n      const next = new Set(prev);\n      if (next.has(id)) next.delete(id);else next.add(id);\n      return next;\n    });\n  };\n  const selectAll = () => {\n    if (!invoiceData || finalized) return;\n    setSelectedIds(new Set(invoiceData.lineItems.map(li => li.id)));\n  };\n  const clearAll = () => {\n    if (finalized) return;\n    setSelectedIds(new Set());\n  };\n\n  // Compute totals from selected items\n  const selectedLineItems = useMemo(() => {\n    if (!invoiceData) return [];\n    return invoiceData.lineItems.filter(li => selectedIds.has(li.id));\n  }, [invoiceData, selectedIds]);\n  const computedTotals = useMemo(() => {\n    const hours = selectedLineItems.reduce((s, i) => s + i.hours, 0);\n    const amount = selectedLineItems.reduce((s, i) => s + i.amount, 0);\n    return {\n      hours,\n      amount\n    };\n  }, [selectedLineItems]);\n\n  // Finalize invoice: mark selected entries as invoiced & persist snapshot history\n  const finalizeInvoice = () => {\n    var _invoiceData$job;\n    if (!invoiceData) return;\n    if (selectedIds.size === 0) {\n      alert('Select at least one line item to finalize the invoice.');\n      return;\n    }\n    const updatedEntries = appData.entries.map(e => selectedIds.has(e.id) ? {\n      ...e,\n      invoiced: true\n    } : e);\n    const updatedCharges = (appData.charges || []).map(c => selectedIds.has(c.id) ? {\n      ...c,\n      invoiced: true\n    } : c);\n    const snapshot = {\n      id: dataService.generateId(),\n      invoiceNumber: invoiceData.invoiceNumber,\n      clientId: invoiceData.client.id,\n      jobId: ((_invoiceData$job = invoiceData.job) === null || _invoiceData$job === void 0 ? void 0 : _invoiceData$job.id) || null,\n      dateRange: invoiceData.dateRange,\n      generatedAt: Date.now(),\n      lineItems: selectedLineItems.map(li => ({\n        id: li.id,\n        kind: li.kind || 'time',\n        chargeType: li.chargeType,\n        date: li.date,\n        task: li.task,\n        notes: li.notes,\n        hours: li.hours,\n        rate: li.rate,\n        quantity: li.quantity,\n        unitCost: li.unitCost,\n        amount: li.amount\n      })),\n      subtotal: computedTotals.amount,\n      total: computedTotals.amount\n    };\n    let patch = {\n      entries: updatedEntries,\n      charges: updatedCharges,\n      invoices: [...(appData.invoices || []), snapshot]\n    };\n    if (closeJobOnFinalize && invoiceData.job) {\n      const updatedJobs = (appData.jobs || []).map(j => j.id === invoiceData.job.id ? {\n        ...j,\n        closed: true,\n        closedAt: Date.now()\n      } : j);\n      patch.jobs = updatedJobs;\n    }\n    updateAppData(patch);\n    setFinalized(true);\n  };\n\n  // Export invoice as CSV\n  const exportCSV = () => {\n    if (!invoiceData) return;\n    const headers = ['Date', 'Task', 'Notes', 'Hours', 'Rate', 'Amount'];\n    const rows = selectedLineItems.map(item => [item.date, item.task, item.notes, item.hours.toFixed(2), item.rate.toFixed(2), item.amount.toFixed(2)]);\n\n    // Add totals row\n    rows.push(['', '', 'TOTAL', computedTotals.hours.toFixed(2), '', computedTotals.amount.toFixed(2)]);\n    const csvContent = [headers, ...rows].map(row => row.map(cell => `\"${cell}\"`).join(',')).join('\\n');\n    const blob = new Blob([csvContent], {\n      type: 'text/csv'\n    });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `invoice-${invoiceData.client.name}-${invoiceData.dateRange.start}-to-${invoiceData.dateRange.end}.csv`;\n    link.click();\n    URL.revokeObjectURL(url);\n  };\n\n  // Print invoice\n  const printInvoice = () => {\n    if (!invoiceData) return;\n    const printWindow = window.open('', '_blank');\n    const printContent = generatePrintHTML({\n      ...invoiceData,\n      lineItems: selectedLineItems,\n      totals: computedTotals\n    });\n    printWindow.document.write(printContent);\n    printWindow.document.close();\n    printWindow.focus();\n    printWindow.print();\n  };\n\n  // Generate HTML for printing\n  const generatePrintHTML = invoice => {\n    return `\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Invoice - ${invoice.client.name}</title>\n    <style>\n        body { font-family: Arial, sans-serif; margin: 40px; color: #333; }\n        .header { text-align: center; margin-bottom: 40px; }\n        .invoice-title { font-size: 28px; font-weight: bold; color: #2563eb; }\n        .invoice-info { display: flex; justify-content: space-between; margin-bottom: 30px; }\n        .client-info h3, .invoice-details h3 { margin-top: 0; color: #374151; }\n        table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }\n        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #e5e7eb; }\n        th { background-color: #f9fafb; font-weight: bold; }\n        .amount { text-align: right; }\n        .totals { font-weight: bold; background-color: #f3f4f6; }\n        .footer { margin-top: 40px; text-align: center; color: #6b7280; font-size: 14px; }\n        @media print {\n            body { margin: 20px; }\n            .no-print { display: none; }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <div class=\"invoice-title\">INVOICE</div>\n        <div style=\"margin-top: 10px; color: #6b7280;\">Mechanic Hours Time Tracking</div>\n    </div>\n    \n    <div class=\"invoice-info\">\n        <div class=\"client-info\">\n            <h3>Bill To:</h3>\n            <div><strong>${invoice.client.name}</strong></div>\n            ${invoice.client.contact ? `<div>${invoice.client.contact}</div>` : ''}\n        </div>\n        \n        <div class=\"invoice-details\">\n            <h3>Invoice Details:</h3>\n            <div><strong>Invoice #:</strong> ${invoice.invoiceNumber}</div>\n            <div><strong>Date:</strong> ${invoice.generatedDate}</div>\n            <div><strong>Period:</strong> ${invoice.dateRange.start} - ${invoice.dateRange.end}</div>\n        </div>\n    </div>\n    \n    <table>\n        <thead>\n            <tr>\n                <th>Date</th>\n                <th>Task</th>\n                <th>Notes</th>\n                <th>Hours</th>\n                <th>Rate</th>\n                <th class=\"amount\">Amount</th>\n            </tr>\n        </thead>\n        <tbody>\n            ${invoice.lineItems.map(item => `\n                <tr>\n                    <td>${item.date}</td>\n                    <td>${item.task}</td>\n                    <td>${item.notes}</td>\n                    <td>${item.hours.toFixed(2)}</td>\n                    <td>${dataService.formatCurrency(item.rate)}</td>\n                    <td class=\"amount\">${dataService.formatCurrency(item.amount)}</td>\n                </tr>\n            `).join('')}\n      <tr class=\"totals\">\n        <td colspan=\"3\">TOTAL</td>\n        <td><strong>${invoice.totals.hours.toFixed(2)}</strong></td>\n        <td></td>\n        <td class=\"amount\"><strong>${dataService.formatCurrency(invoice.totals.amount)}</strong></td>\n      </tr>\n        </tbody>\n    </table>\n    \n    <div class=\"footer\">\n        <p>Generated by Mechanic Hours - www.context7.com</p>\n        <p>Thank you for your business!</p>\n    </div>\n</body>\n</html>\n    `;\n  };\n\n  // Clear invoice\n  const clearInvoice = () => {\n    setInvoiceData(null);\n    setSelectedClient('');\n    setStartDate('');\n    setEndDate('');\n    setSelectedIds(new Set());\n    setFinalized(false);\n    setSelectedJobId('');\n    setMode('client');\n    setCloseJobOnFinalize(false);\n    clearInvoiceContext && clearInvoiceContext();\n  };\n\n  // Set quick date ranges\n  const setThisWeek = () => {\n    const now = new Date();\n    const startOfWeek = new Date(now);\n    startOfWeek.setDate(now.getDate() - now.getDay()); // Start of week (Sunday)\n\n    setStartDate(startOfWeek.toISOString().slice(0, 10));\n    setEndDate(now.toISOString().slice(0, 10));\n  };\n  const setThisMonth = () => {\n    const now = new Date();\n    const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);\n    setStartDate(startOfMonth.toISOString().slice(0, 10));\n    setEndDate(now.toISOString().slice(0, 10));\n  };\n  const setLastMonth = () => {\n    const now = new Date();\n    const startOfLastMonth = new Date(now.getFullYear(), now.getMonth() - 1, 1);\n    const endOfLastMonth = new Date(now.getFullYear(), now.getMonth(), 0);\n    setStartDate(startOfLastMonth.toISOString().slice(0, 10));\n    setEndDate(endOfLastMonth.toISOString().slice(0, 10));\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: [!invoiceData ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Card, {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl font-bold mb-4\",\n          children: \"Generate Invoice\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex gap-2 mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            size: \"small\",\n            variant: mode === 'client' ? 'primary' : 'secondary',\n            onClick: () => setMode('client'),\n            \"aria-label\": \"Invoice by client\",\n            children: \"By Client\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 384,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            size: \"small\",\n            variant: mode === 'job' ? 'primary' : 'secondary',\n            onClick: () => setMode('job'),\n            \"aria-label\": \"Invoice by job\",\n            children: \"By Job\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 385,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 383,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Select, {\n          label: \"Client\",\n          value: selectedClient,\n          onChange: e => {\n            setSelectedClient(e.target.value);\n            if (mode === 'job') setSelectedJobId('');\n          },\n          options: clientOptions,\n          placeholder: \"Select a client\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 388,\n          columnNumber: 13\n        }, this), mode === 'job' && selectedClient && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"input-label\",\n            children: \"Job\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 398,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            className: \"select\",\n            value: selectedJobId,\n            onChange: e => setSelectedJobId(e.target.value),\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"-- Select Job --\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 404,\n              columnNumber: 19\n            }, this), (appData.jobs || []).filter(j => !j.closed).filter(j => {\n              const hasBillableEntries = (appData.entries || []).some(e => e.jobId === j.id && e.clientId === selectedClient && e.end && !e.invoiced);\n              const hasBillableCharges = (appData.charges || []).some(c => c.jobId === j.id && c.clientId === selectedClient && !c.invoiced);\n              return hasBillableEntries || hasBillableCharges;\n            }).sort((a, b) => a.name.localeCompare(b.name)).map(j => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: j.id,\n              children: j.name\n            }, j.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 413,\n              columnNumber: 31\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 399,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 md:grid-cols-2 gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(Input, {\n            label: \"Start Date\",\n            type: \"date\",\n            value: startDate,\n            onChange: e => setStartDate(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 419,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            label: \"End Date\",\n            type: \"date\",\n            value: endDate,\n            onChange: e => setEndDate(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 426,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 418,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-wrap gap-2 mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            variant: \"secondary\",\n            size: \"small\",\n            onClick: setThisWeek,\n            \"aria-label\": \"Set date range to this week\",\n            children: \"This Week\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 436,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"secondary\",\n            size: \"small\",\n            onClick: setThisMonth,\n            \"aria-label\": \"Set date range to this month\",\n            children: \"This Month\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 439,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"secondary\",\n            size: \"small\",\n            onClick: setLastMonth,\n            \"aria-label\": \"Set date range to last month\",\n            children: \"Last Month\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 442,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 435,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: generateInvoice,\n          className: \"w-full\",\n          disabled: !selectedClient || !startDate || !endDate || mode === 'job' && !selectedJobId,\n          children: [\"\\uD83D\\uDCC4 Generate \", mode === 'job' ? 'Job' : 'Client', \" Invoice\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 11\n      }, this), appData.clients.length > 0 && /*#__PURE__*/_jsxDEV(Card, {\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold mb-4\",\n          children: \"Quick Stats\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 459,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 md:grid-cols-3 gap-4 text-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-2xl font-bold text-primary-600\",\n              children: appData.clients.length\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 462,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-600\",\n              children: \"Active Clients\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 465,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 461,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-2xl font-bold text-green-600\",\n              children: appData.entries.filter(e => e.end).length\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 468,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-600\",\n              children: \"Completed Entries\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 471,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 467,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-2xl font-bold text-blue-600\",\n              children: [dataService.calculateTotalHours(appData.entries.filter(e => e.end)).toFixed(1), \"h\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 474,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-600\",\n              children: \"Total Hours\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 477,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 473,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 460,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 458,\n        columnNumber: 13\n      }, this), appData.invoices && appData.invoices.length > 0 && /*#__PURE__*/_jsxDEV(Card, {\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold mb-3\",\n          children: \"Invoice History\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 485,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2 max-h-56 overflow-y-auto\",\n          children: appData.invoices.slice().sort((a, b) => b.generatedAt - a.generatedAt).map(inv => {\n            const client = appData.clients.find(c => c.id === inv.clientId);\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"individual-job-card\",\n              style: {\n                marginBottom: 0\n              },\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"job-card-content\",\n                style: {\n                  alignItems: 'center'\n                },\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"job-main-info\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"job-title\",\n                    children: inv.invoiceNumber\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 493,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"schedule-compact-row\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"job-time\",\n                      children: [inv.dateRange.start, \" \\u2192 \", inv.dateRange.end]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 495,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"schedule-meta-divider\",\n                      children: \"\\u2022\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 496,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"job-client\",\n                      children: (client === null || client === void 0 ? void 0 : client.name) || 'Unknown Client'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 497,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"schedule-meta-divider\",\n                      children: \"\\u2022\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 498,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"job-time\",\n                      children: dataService.formatCurrency(inv.total)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 499,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 494,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 492,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 491,\n                columnNumber: 23\n              }, this)\n            }, inv.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 490,\n              columnNumber: 21\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 486,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 484,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(Card, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-start mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"text-xl font-bold\",\n              children: \"Invoice\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 515,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-500\",\n              children: [invoiceData.invoiceNumber, !finalized && ' (Draft)', \" \", invoiceData.job && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ml-1 px-1 rounded bg-blue-600 text-white text-xs\",\n                children: [\"Job: \", invoiceData.job.name]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 516,\n                columnNumber: 128\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 516,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xs text-gray-500\",\n              children: [invoiceData.dateRange.start, \" - \", invoiceData.dateRange.end]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 517,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 514,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"secondary\",\n            size: \"small\",\n            onClick: clearInvoice,\n            children: \"Back\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 519,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 513,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"font-semibold\",\n            children: invoiceData.client.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 522,\n            columnNumber: 15\n          }, this), invoiceData.client.contact && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-gray-400\",\n            children: invoiceData.client.contact\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 523,\n            columnNumber: 46\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 521,\n          columnNumber: 13\n        }, this), !finalized && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-wrap gap-2 mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            size: \"small\",\n            variant: \"secondary\",\n            onClick: selectAll,\n            \"aria-label\": \"Select all line items\",\n            children: \"Select All\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 528,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            size: \"small\",\n            variant: \"secondary\",\n            onClick: clearAll,\n            \"aria-label\": \"Clear all line items\",\n            children: \"Clear All\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 529,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            size: \"small\",\n            onClick: finalizeInvoice,\n            disabled: selectedIds.size === 0,\n            \"aria-label\": \"Finalize invoice and mark entries invoiced\",\n            children: \"Finalize & Mark Invoiced\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 530,\n            columnNumber: 17\n          }, this), invoiceData.job && /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"flex items-center gap-1 text-xs text-gray-400 ml-auto\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              checked: closeJobOnFinalize,\n              onChange: () => setCloseJobOnFinalize(v => !v)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 533,\n              columnNumber: 21\n            }, this), \" Close Job\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 532,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 527,\n          columnNumber: 15\n        }, this), finalized && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-2 text-xs text-green-600 font-medium\",\n          children: [\"Finalized \\u2022 \", selectedIds.size, \" items marked invoiced\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 540,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"activity-list\",\n          children: invoiceData.lineItems.map(item => {\n            const checked = selectedIds.has(item.id);\n            const disabled = finalized;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `individual-job-card ${!checked ? 'opacity-50' : ''}`,\n              style: {\n                position: 'relative'\n              },\n              children: [!finalized && /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"checkbox\",\n                checked: checked,\n                onChange: () => toggleLineItem(item.id),\n                style: {\n                  position: 'absolute',\n                  top: 6,\n                  left: 6,\n                  width: 16,\n                  height: 16\n                },\n                disabled: disabled,\n                title: \"Include in invoice\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 549,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"job-card-content\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"job-main-info\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"job-title\",\n                    children: item.task\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 560,\n                    columnNumber: 23\n                  }, this), item.kind === 'charge' ? /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"job-time\",\n                    children: [item.date, \" \\u2022 \", item.quantity, \" x \", dataService.formatCurrency(item.rate)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 562,\n                    columnNumber: 25\n                  }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"job-time\",\n                    children: [item.date, \" \\u2022 \", item.hours.toFixed(2), \"h @ \", dataService.formatCurrency(item.rate)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 564,\n                    columnNumber: 25\n                  }, this), item.notes && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"job-notes\",\n                    children: item.notes\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 566,\n                    columnNumber: 38\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 559,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"job-actions\",\n                  style: {\n                    alignItems: 'flex-end'\n                  },\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"stat-value stat-value-success\",\n                    style: {\n                      fontSize: '0.85rem'\n                    },\n                    children: dataService.formatCurrency(item.amount)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 569,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 568,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 558,\n                columnNumber: 19\n              }, this)]\n            }, item.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 547,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 542,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"separator\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 575,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between text-sm font-semibold\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Total Hours\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 577,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [computedTotals.hours.toFixed(2), \"h\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 578,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 576,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between text-sm font-semibold mt-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Total Amount\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 581,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: dataService.formatCurrency(computedTotals.amount)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 582,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 580,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex gap-2 mt-4\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            onClick: printInvoice,\n            className: \"flex-1\",\n            size: \"small\",\n            \"aria-label\": \"Print invoice\",\n            children: \"Print\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 585,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"secondary\",\n            onClick: exportCSV,\n            className: \"flex-1\",\n            size: \"small\",\n            \"aria-label\": \"Export invoice CSV\",\n            children: \"CSV\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 586,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 584,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 512,\n        columnNumber: 11\n      }, this)\n    }, void 0, false), appData.entries.filter(e => e.end).length === 0 && /*#__PURE__*/_jsxDEV(Card, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center py-6 text-gray-600\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mb-2\",\n          children: \"No completed time entries found.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 596,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Start tracking time to generate invoices!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 597,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 595,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 594,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 376,\n    columnNumber: 5\n  }, this);\n};\n_s(InvoiceTab, \"nvsceRoGGKz7dc30dftme7W/CTo=\");\n_c = InvoiceTab;\nexport default InvoiceTab;\nvar _c;\n$RefreshReg$(_c, \"InvoiceTab\");","map":{"version":3,"names":["React","useState","useMemo","Card","Button","Input","Select","dataService","jsxDEV","_jsxDEV","Fragment","_Fragment","InvoiceTab","appData","updateAppData","invoiceContext","clearInvoiceContext","_s","selectedClient","setSelectedClient","startDate","setStartDate","endDate","setEndDate","invoiceData","setInvoiceData","selectedIds","setSelectedIds","Set","finalized","setFinalized","mode","setMode","jobId","selectedJobId","setSelectedJobId","closeJobOnFinalize","setCloseJobOnFinalize","clientOptions","clients","map","client","value","id","label","name","generateInvoice","alert","find","c","start","parseLocalDate","Date","end","setHours","clientEntries","entries","filter","entry","clientId","invoiced","entryDate","clientCharges","charges","ch","chDate","createdAt","length","timeLineItems","taskName","duration","hours","durationToHours","amount","rate","date","formatDate","task","notes","chargeLineItems","kind","chargeType","description","unitPrice","quantity","unitCost","amountCached","lineItems","jobMeta","jobs","j","invoice","dateRange","job","generatedDate","invoiceNumber","now","li","toggleLineItem","prev","next","has","delete","add","selectAll","clearAll","selectedLineItems","computedTotals","reduce","s","i","finalizeInvoice","_invoiceData$job","size","updatedEntries","e","updatedCharges","snapshot","generateId","generatedAt","subtotal","total","patch","invoices","updatedJobs","closed","closedAt","exportCSV","headers","rows","item","toFixed","push","csvContent","row","cell","join","blob","Blob","type","url","URL","createObjectURL","link","document","createElement","href","download","click","revokeObjectURL","printInvoice","printWindow","window","open","printContent","generatePrintHTML","totals","write","close","focus","print","contact","formatCurrency","clearInvoice","setThisWeek","startOfWeek","setDate","getDate","getDay","toISOString","slice","setThisMonth","startOfMonth","getFullYear","getMonth","setLastMonth","startOfLastMonth","endOfLastMonth","className","children","fileName","_jsxFileName","lineNumber","columnNumber","variant","onClick","onChange","target","options","placeholder","hasBillableEntries","some","hasBillableCharges","sort","a","b","localeCompare","disabled","calculateTotalHours","inv","style","marginBottom","alignItems","checked","v","position","top","left","width","height","title","fontSize","_c","$RefreshReg$"],"sources":["C:/Users/jurgl/HTMLProjects/CrickTime/src/components/tabs/InvoiceTab.js"],"sourcesContent":["import React, { useState, useMemo } from 'react';\r\nimport Card from '../ui/Card';\r\nimport Button from '../ui/Button';\r\nimport Input from '../ui/Input';\r\nimport Select from '../ui/Select';\r\nimport { dataService } from '../../utils/dataService';\r\n\r\n/**\r\n * Invoice Tab Component\r\n * Reference: www.context7.com for invoice generation patterns\r\n */\r\nconst InvoiceTab = ({ appData, updateAppData, invoiceContext, clearInvoiceContext }) => {\r\n  const [selectedClient, setSelectedClient] = useState('');\r\n  const [startDate, setStartDate] = useState('');\r\n  const [endDate, setEndDate] = useState('');\r\n  const [invoiceData, setInvoiceData] = useState(null); // holds draft or finalized invoice meta & all candidate line items\r\n  const [selectedIds, setSelectedIds] = useState(new Set());\r\n  const [finalized, setFinalized] = useState(false);\r\n  const [mode, setMode] = useState(invoiceContext?.jobId ? 'job' : 'client'); // 'client' | 'job'\r\n  const [selectedJobId, setSelectedJobId] = useState(invoiceContext?.jobId || '');\r\n  const [closeJobOnFinalize, setCloseJobOnFinalize] = useState(false);\r\n\r\n  // Get client options\r\n  const clientOptions = appData.clients.map(client => ({\r\n    value: client.id,\r\n    label: client.name\r\n  }));\r\n\r\n  // Generate draft invoice data (does NOT mark entries/charges invoiced yet)\r\n  const generateInvoice = () => {\r\n    if (!selectedClient || !startDate || !endDate) {\r\n      alert('Please select a client and date range');\r\n      return;\r\n    }\r\n\r\n    if (mode === 'job' && !selectedJobId) {\r\n      alert('Select a job for Job mode');\r\n      return;\r\n    }\r\n\r\n    const client = appData.clients.find(c => c.id === selectedClient);\r\n    if (!client) {\r\n      alert('Selected client not found');\r\n      return;\r\n    }\r\n\r\n  const start = dataService.parseLocalDate(startDate) || new Date(startDate);\r\n  const end = dataService.parseLocalDate(endDate) || new Date(endDate);\r\n    end.setHours(23, 59, 59, 999); // Include full end date\r\n\r\n    if (start > end) {\r\n      alert('Start date must be before end date');\r\n      return;\r\n    }\r\n\r\n    // Get entries for the client and date range\r\n    const clientEntries = appData.entries.filter(entry => {\r\n      if (!entry.end || entry.clientId !== selectedClient) return false;\r\n      if (entry.invoiced) return false; // skip already invoiced\r\n      if (mode === 'job' && entry.jobId !== selectedJobId) return false;\r\n      \r\n      const entryDate = new Date(entry.start);\r\n      return entryDate >= start && entryDate <= end;\r\n    });\r\n\r\n    // Get charges for client within date range\r\n    const clientCharges = (appData.charges||[]).filter(ch => {\r\n      if (ch.invoiced) return false;\r\n      if (ch.clientId !== selectedClient) return false;\r\n      if (mode === 'job' && ch.jobId !== selectedJobId) return false;\r\n      const chDate = new Date(ch.createdAt);\r\n      return chDate >= start && chDate <= end;\r\n    });\r\n\r\n    if (clientEntries.length === 0 && clientCharges.length === 0) {\r\n      alert('No billable entries or charges found for the selected criteria');\r\n      return;\r\n    }\r\n\r\n  // Create candidate line items (all initially selected)\r\n  const timeLineItems = clientEntries.map(entry => {\r\n      const taskName = entry.taskName || 'Unknown Task';\r\n      const duration = entry.end - entry.start;\r\n      const hours = dataService.durationToHours(duration);\r\n      const amount = hours * client.rate;\r\n\r\n      return {\r\n        id: entry.id,\r\n        date: dataService.formatDate(entry.start),\r\n        task: taskName,\r\n        notes: entry.notes || '',\r\n        hours: hours,\r\n        rate: client.rate,\r\n        amount: amount\r\n      };\r\n    });\r\n\r\n    const chargeLineItems = clientCharges.map(ch => ({\r\n      id: ch.id,\r\n      kind: 'charge',\r\n      chargeType: ch.kind,\r\n      date: dataService.formatDate(ch.createdAt),\r\n      task: ch.description,\r\n      notes: '',\r\n      hours: 0,\r\n  rate: ch.unitPrice,\r\n      quantity: ch.quantity,\r\n  unitCost: ch.unitCost,\r\n      amount: ch.amountCached\r\n    }));\r\n\r\n    const lineItems = [...timeLineItems, ...chargeLineItems];\r\n\r\n    const jobMeta = mode === 'job' ? (appData.jobs || []).find(j => j.id === selectedJobId) : null;\r\n    const invoice = {\r\n      client,\r\n      dateRange: {\r\n        start: dataService.formatDate(start),\r\n        end: dataService.formatDate(end)\r\n      },\r\n      lineItems,\r\n      job: jobMeta ? { id: jobMeta.id, name: jobMeta.name } : null,\r\n      generatedDate: dataService.formatDate(new Date()),\r\n      invoiceNumber: `INV-${Date.now()}`\r\n    };\r\n\r\n    setInvoiceData(invoice);\r\n  setSelectedIds(new Set(lineItems.map(li => li.id)));\r\n    setFinalized(false);\r\n  };\r\n\r\n  // Toggle selection of a line item\r\n  const toggleLineItem = (id) => {\r\n    if (finalized) return;\r\n    setSelectedIds(prev => {\r\n      const next = new Set(prev);\r\n      if (next.has(id)) next.delete(id); else next.add(id);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const selectAll = () => {\r\n    if (!invoiceData || finalized) return;\r\n    setSelectedIds(new Set(invoiceData.lineItems.map(li => li.id)));\r\n  };\r\n\r\n  const clearAll = () => {\r\n    if (finalized) return;\r\n    setSelectedIds(new Set());\r\n  };\r\n\r\n  // Compute totals from selected items\r\n  const selectedLineItems = useMemo(() => {\r\n    if (!invoiceData) return [];\r\n    return invoiceData.lineItems.filter(li => selectedIds.has(li.id));\r\n  }, [invoiceData, selectedIds]);\r\n\r\n  const computedTotals = useMemo(() => {\r\n    const hours = selectedLineItems.reduce((s, i) => s + i.hours, 0);\r\n    const amount = selectedLineItems.reduce((s, i) => s + i.amount, 0);\r\n    return { hours, amount };\r\n  }, [selectedLineItems]);\r\n\r\n  // Finalize invoice: mark selected entries as invoiced & persist snapshot history\r\n  const finalizeInvoice = () => {\r\n    if (!invoiceData) return;\r\n    if (selectedIds.size === 0) {\r\n      alert('Select at least one line item to finalize the invoice.');\r\n      return;\r\n    }\r\n  const updatedEntries = appData.entries.map(e => selectedIds.has(e.id) ? { ...e, invoiced: true } : e);\r\n  const updatedCharges = (appData.charges||[]).map(c => selectedIds.has(c.id) ? { ...c, invoiced: true } : c);\r\n    const snapshot = {\r\n      id: dataService.generateId(),\r\n      invoiceNumber: invoiceData.invoiceNumber,\r\n      clientId: invoiceData.client.id,\r\n      jobId: invoiceData.job?.id || null,\r\n      dateRange: invoiceData.dateRange,\r\n      generatedAt: Date.now(),\r\n      lineItems: selectedLineItems.map(li => ({\r\n        id: li.id,\r\n  kind: li.kind || 'time',\r\n  chargeType: li.chargeType,\r\n        date: li.date,\r\n        task: li.task,\r\n        notes: li.notes,\r\n        hours: li.hours,\r\n        rate: li.rate,\r\n  quantity: li.quantity,\r\n  unitCost: li.unitCost,\r\n        amount: li.amount\r\n      })),\r\n      subtotal: computedTotals.amount,\r\n      total: computedTotals.amount\r\n    };\r\n  let patch = { entries: updatedEntries, charges: updatedCharges, invoices: [...(appData.invoices||[]), snapshot] };\r\n    if (closeJobOnFinalize && invoiceData.job) {\r\n      const updatedJobs = (appData.jobs || []).map(j => j.id === invoiceData.job.id ? { ...j, closed: true, closedAt: Date.now() } : j);\r\n      patch.jobs = updatedJobs;\r\n    }\r\n    updateAppData(patch);\r\n    setFinalized(true);\r\n  };\r\n\r\n  // Export invoice as CSV\r\n  const exportCSV = () => {\r\n    if (!invoiceData) return;\r\n\r\n    const headers = ['Date', 'Task', 'Notes', 'Hours', 'Rate', 'Amount'];\r\n    const rows = selectedLineItems.map(item => [\r\n      item.date,\r\n      item.task,\r\n      item.notes,\r\n      item.hours.toFixed(2),\r\n      item.rate.toFixed(2),\r\n      item.amount.toFixed(2)\r\n    ]);\r\n\r\n    // Add totals row\r\n    rows.push(['', '', 'TOTAL', computedTotals.hours.toFixed(2), '', computedTotals.amount.toFixed(2)]);\r\n\r\n    const csvContent = [headers, ...rows]\r\n      .map(row => row.map(cell => `\"${cell}\"`).join(','))\r\n      .join('\\n');\r\n\r\n    const blob = new Blob([csvContent], { type: 'text/csv' });\r\n    const url = URL.createObjectURL(blob);\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    link.download = `invoice-${invoiceData.client.name}-${invoiceData.dateRange.start}-to-${invoiceData.dateRange.end}.csv`;\r\n    link.click();\r\n    URL.revokeObjectURL(url);\r\n  };\r\n\r\n  // Print invoice\r\n  const printInvoice = () => {\r\n    if (!invoiceData) return;\r\n\r\n    const printWindow = window.open('', '_blank');\r\n    const printContent = generatePrintHTML({ ...invoiceData, lineItems: selectedLineItems, totals: computedTotals });\r\n    \r\n    printWindow.document.write(printContent);\r\n    printWindow.document.close();\r\n    printWindow.focus();\r\n    printWindow.print();\r\n  };\r\n\r\n  // Generate HTML for printing\r\n  const generatePrintHTML = (invoice) => {\r\n    return `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n    <title>Invoice - ${invoice.client.name}</title>\r\n    <style>\r\n        body { font-family: Arial, sans-serif; margin: 40px; color: #333; }\r\n        .header { text-align: center; margin-bottom: 40px; }\r\n        .invoice-title { font-size: 28px; font-weight: bold; color: #2563eb; }\r\n        .invoice-info { display: flex; justify-content: space-between; margin-bottom: 30px; }\r\n        .client-info h3, .invoice-details h3 { margin-top: 0; color: #374151; }\r\n        table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }\r\n        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #e5e7eb; }\r\n        th { background-color: #f9fafb; font-weight: bold; }\r\n        .amount { text-align: right; }\r\n        .totals { font-weight: bold; background-color: #f3f4f6; }\r\n        .footer { margin-top: 40px; text-align: center; color: #6b7280; font-size: 14px; }\r\n        @media print {\r\n            body { margin: 20px; }\r\n            .no-print { display: none; }\r\n        }\r\n    </style>\r\n</head>\r\n<body>\r\n    <div class=\"header\">\r\n        <div class=\"invoice-title\">INVOICE</div>\r\n        <div style=\"margin-top: 10px; color: #6b7280;\">Mechanic Hours Time Tracking</div>\r\n    </div>\r\n    \r\n    <div class=\"invoice-info\">\r\n        <div class=\"client-info\">\r\n            <h3>Bill To:</h3>\r\n            <div><strong>${invoice.client.name}</strong></div>\r\n            ${invoice.client.contact ? `<div>${invoice.client.contact}</div>` : ''}\r\n        </div>\r\n        \r\n        <div class=\"invoice-details\">\r\n            <h3>Invoice Details:</h3>\r\n            <div><strong>Invoice #:</strong> ${invoice.invoiceNumber}</div>\r\n            <div><strong>Date:</strong> ${invoice.generatedDate}</div>\r\n            <div><strong>Period:</strong> ${invoice.dateRange.start} - ${invoice.dateRange.end}</div>\r\n        </div>\r\n    </div>\r\n    \r\n    <table>\r\n        <thead>\r\n            <tr>\r\n                <th>Date</th>\r\n                <th>Task</th>\r\n                <th>Notes</th>\r\n                <th>Hours</th>\r\n                <th>Rate</th>\r\n                <th class=\"amount\">Amount</th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            ${invoice.lineItems.map(item => `\r\n                <tr>\r\n                    <td>${item.date}</td>\r\n                    <td>${item.task}</td>\r\n                    <td>${item.notes}</td>\r\n                    <td>${item.hours.toFixed(2)}</td>\r\n                    <td>${dataService.formatCurrency(item.rate)}</td>\r\n                    <td class=\"amount\">${dataService.formatCurrency(item.amount)}</td>\r\n                </tr>\r\n            `).join('')}\r\n      <tr class=\"totals\">\r\n        <td colspan=\"3\">TOTAL</td>\r\n        <td><strong>${invoice.totals.hours.toFixed(2)}</strong></td>\r\n        <td></td>\r\n        <td class=\"amount\"><strong>${dataService.formatCurrency(invoice.totals.amount)}</strong></td>\r\n      </tr>\r\n        </tbody>\r\n    </table>\r\n    \r\n    <div class=\"footer\">\r\n        <p>Generated by Mechanic Hours - www.context7.com</p>\r\n        <p>Thank you for your business!</p>\r\n    </div>\r\n</body>\r\n</html>\r\n    `;\r\n  };\r\n\r\n  // Clear invoice\r\n  const clearInvoice = () => {\r\n    setInvoiceData(null);\r\n    setSelectedClient('');\r\n    setStartDate('');\r\n    setEndDate('');\r\n    setSelectedIds(new Set());\r\n    setFinalized(false);\r\n    setSelectedJobId('');\r\n    setMode('client');\r\n    setCloseJobOnFinalize(false);\r\n    clearInvoiceContext && clearInvoiceContext();\r\n  };\r\n\r\n  // Set quick date ranges\r\n  const setThisWeek = () => {\r\n    const now = new Date();\r\n    const startOfWeek = new Date(now);\r\n    startOfWeek.setDate(now.getDate() - now.getDay()); // Start of week (Sunday)\r\n    \r\n    setStartDate(startOfWeek.toISOString().slice(0, 10));\r\n    setEndDate(now.toISOString().slice(0, 10));\r\n  };\r\n\r\n  const setThisMonth = () => {\r\n    const now = new Date();\r\n    const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);\r\n    \r\n    setStartDate(startOfMonth.toISOString().slice(0, 10));\r\n    setEndDate(now.toISOString().slice(0, 10));\r\n  };\r\n\r\n  const setLastMonth = () => {\r\n    const now = new Date();\r\n    const startOfLastMonth = new Date(now.getFullYear(), now.getMonth() - 1, 1);\r\n    const endOfLastMonth = new Date(now.getFullYear(), now.getMonth(), 0);\r\n    \r\n    setStartDate(startOfLastMonth.toISOString().slice(0, 10));\r\n    setEndDate(endOfLastMonth.toISOString().slice(0, 10));\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n  {!invoiceData ? (\r\n        <>\r\n          {/* Invoice Generation Form */}\r\n          <Card>\r\n            <h2 className=\"text-xl font-bold mb-4\">Generate Invoice</h2>\r\n\r\n            <div className=\"flex gap-2 mb-3\">\r\n              <Button size=\"small\" variant={mode==='client'?'primary':'secondary'} onClick={()=>setMode('client')} aria-label=\"Invoice by client\">By Client</Button>\r\n              <Button size=\"small\" variant={mode==='job'?'primary':'secondary'} onClick={()=>setMode('job')} aria-label=\"Invoice by job\">By Job</Button>\r\n            </div>\r\n            \r\n            <Select\r\n              label=\"Client\"\r\n              value={selectedClient}\r\n              onChange={(e) => { setSelectedClient(e.target.value); if(mode==='job') setSelectedJobId(''); }}\r\n              options={clientOptions}\r\n              placeholder=\"Select a client\"\r\n            />\r\n\r\n      {mode === 'job' && selectedClient && (\r\n              <div className=\"mb-3\">\r\n                <label className=\"input-label\">Job</label>\r\n                <select\r\n                  className=\"select\"\r\n                  value={selectedJobId}\r\n                  onChange={(e)=>setSelectedJobId(e.target.value)}\r\n                >\r\n                  <option value=\"\">-- Select Job --</option>\r\n                  {(appData.jobs||[])\r\n                    .filter(j=>!j.closed)\r\n        .filter(j=> {\r\n          const hasBillableEntries = (appData.entries||[]).some(e=>e.jobId===j.id && e.clientId===selectedClient && e.end && !e.invoiced);\r\n          const hasBillableCharges = (appData.charges||[]).some(c=>c.jobId===j.id && c.clientId===selectedClient && !c.invoiced);\r\n          return hasBillableEntries || hasBillableCharges;\r\n        })\r\n                    .sort((a,b)=>a.name.localeCompare(b.name))\r\n                    .map(j => <option key={j.id} value={j.id}>{j.name}</option>)}\r\n                </select>\r\n              </div>\r\n            )}\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n              <Input\r\n                label=\"Start Date\"\r\n                type=\"date\"\r\n                value={startDate}\r\n                onChange={(e) => setStartDate(e.target.value)}\r\n              />\r\n              \r\n              <Input\r\n                label=\"End Date\"\r\n                type=\"date\"\r\n                value={endDate}\r\n                onChange={(e) => setEndDate(e.target.value)}\r\n              />\r\n            </div>\r\n            \r\n            {/* Quick Date Buttons */}\r\n            <div className=\"flex flex-wrap gap-2 mb-4\">\r\n              <Button variant=\"secondary\" size=\"small\" onClick={setThisWeek} aria-label=\"Set date range to this week\">\r\n                This Week\r\n              </Button>\r\n              <Button variant=\"secondary\" size=\"small\" onClick={setThisMonth} aria-label=\"Set date range to this month\">\r\n                This Month\r\n              </Button>\r\n              <Button variant=\"secondary\" size=\"small\" onClick={setLastMonth} aria-label=\"Set date range to last month\">\r\n                Last Month\r\n              </Button>\r\n            </div>\r\n            \r\n            <Button \r\n              onClick={generateInvoice}\r\n              className=\"w-full\"\r\n              disabled={!selectedClient || !startDate || !endDate || (mode==='job' && !selectedJobId)}\r\n            >\r\n               Generate {mode==='job' ? 'Job' : 'Client'} Invoice\r\n            </Button>\r\n          </Card>\r\n\r\n          {/* Summary Statistics */}\r\n          {appData.clients.length > 0 && (\r\n            <Card>\r\n              <h3 className=\"text-lg font-semibold mb-4\">Quick Stats</h3>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-center\">\r\n                <div>\r\n                  <div className=\"text-2xl font-bold text-primary-600\">\r\n                    {appData.clients.length}\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-600\">Active Clients</div>\r\n                </div>\r\n                <div>\r\n                  <div className=\"text-2xl font-bold text-green-600\">\r\n                    {appData.entries.filter(e => e.end).length}\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-600\">Completed Entries</div>\r\n                </div>\r\n                <div>\r\n                  <div className=\"text-2xl font-bold text-blue-600\">\r\n                    {dataService.calculateTotalHours(appData.entries.filter(e => e.end)).toFixed(1)}h\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-600\">Total Hours</div>\r\n                </div>\r\n              </div>\r\n            </Card>\r\n          )}\r\n          {/* Invoice History Stub */}\r\n          { (appData.invoices && appData.invoices.length > 0) && (\r\n            <Card>\r\n              <h3 className=\"text-lg font-semibold mb-3\">Invoice History</h3>\r\n              <div className=\"space-y-2 max-h-56 overflow-y-auto\">\r\n                {appData.invoices.slice().sort((a,b)=>b.generatedAt - a.generatedAt).map(inv => {\r\n                  const client = appData.clients.find(c=>c.id===inv.clientId);\r\n                  return (\r\n                    <div key={inv.id} className=\"individual-job-card\" style={{marginBottom:0}}>\r\n                      <div className=\"job-card-content\" style={{alignItems:'center'}}>\r\n                        <div className=\"job-main-info\">\r\n                          <div className=\"job-title\">{inv.invoiceNumber}</div>\r\n                          <div className=\"schedule-compact-row\">\r\n                            <span className=\"job-time\">{inv.dateRange.start}  {inv.dateRange.end}</span>\r\n                            <span className=\"schedule-meta-divider\"></span>\r\n                            <span className=\"job-client\">{client?.name || 'Unknown Client'}</span>\r\n                            <span className=\"schedule-meta-divider\"></span>\r\n                            <span className=\"job-time\">{dataService.formatCurrency(inv.total)}</span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            </Card>\r\n          )}\r\n        </>\r\n      ) : (\r\n        <>\r\n          <Card>\r\n            <div className=\"flex justify-between items-start mb-4\">\r\n              <div>\r\n                <h2 className=\"text-xl font-bold\">Invoice</h2>\r\n                <p className=\"text-sm text-gray-500\">{invoiceData.invoiceNumber}{!finalized && ' (Draft)'} {invoiceData.job && <span className=\"ml-1 px-1 rounded bg-blue-600 text-white text-xs\">Job: {invoiceData.job.name}</span>}</p>\r\n                <p className=\"text-xs text-gray-500\">{invoiceData.dateRange.start} - {invoiceData.dateRange.end}</p>\r\n              </div>\r\n              <Button variant=\"secondary\" size=\"small\" onClick={clearInvoice}>Back</Button>\r\n            </div>\r\n            <div className=\"mb-4\">\r\n              <div className=\"font-semibold\">{invoiceData.client.name}</div>\r\n              {invoiceData.client.contact && <div className=\"text-xs text-gray-400\">{invoiceData.client.contact}</div>}\r\n            </div>\r\n\r\n            {!finalized && (\r\n              <div className=\"flex flex-wrap gap-2 mb-3\">\r\n                <Button size=\"small\" variant=\"secondary\" onClick={selectAll} aria-label=\"Select all line items\">Select All</Button>\r\n                <Button size=\"small\" variant=\"secondary\" onClick={clearAll} aria-label=\"Clear all line items\">Clear All</Button>\r\n                <Button size=\"small\" onClick={finalizeInvoice} disabled={selectedIds.size === 0} aria-label=\"Finalize invoice and mark entries invoiced\">Finalize & Mark Invoiced</Button>\r\n                {invoiceData.job && (\r\n                  <label className=\"flex items-center gap-1 text-xs text-gray-400 ml-auto\">\r\n                    <input type=\"checkbox\" checked={closeJobOnFinalize} onChange={()=>setCloseJobOnFinalize(v=>!v)} /> Close Job\r\n                  </label>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {finalized && (\r\n              <div className=\"mb-2 text-xs text-green-600 font-medium\">Finalized  {selectedIds.size} items marked invoiced</div>\r\n            )}\r\n            <div className=\"activity-list\">\r\n              {invoiceData.lineItems.map(item => {\r\n                const checked = selectedIds.has(item.id);\r\n                const disabled = finalized;\r\n                return (\r\n                <div key={item.id} className={`individual-job-card ${!checked ? 'opacity-50' : ''}`} style={{position:'relative'}}>\r\n                  {!finalized && (\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={checked}\r\n                      onChange={() => toggleLineItem(item.id)}\r\n                      style={{position:'absolute', top:6, left:6, width:16, height:16}}\r\n                      disabled={disabled}\r\n                      title=\"Include in invoice\"\r\n                    />\r\n                  )}\r\n                  <div className=\"job-card-content\">\r\n                    <div className=\"job-main-info\">\r\n                      <div className=\"job-title\">{item.task}</div>\r\n                      {item.kind === 'charge' ? (\r\n                        <div className=\"job-time\">{item.date}  {item.quantity} x {dataService.formatCurrency(item.rate)}</div>\r\n                      ) : (\r\n                        <div className=\"job-time\">{item.date}  {item.hours.toFixed(2)}h @ {dataService.formatCurrency(item.rate)}</div>\r\n                      )}\r\n                      {item.notes && <div className=\"job-notes\">{item.notes}</div>}\r\n                    </div>\r\n                    <div className=\"job-actions\" style={{alignItems:'flex-end'}}>\r\n                      <div className=\"stat-value stat-value-success\" style={{fontSize:'0.85rem'}}>{dataService.formatCurrency(item.amount)}</div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )})}\r\n            </div>\r\n            <div className=\"separator\" />\r\n            <div className=\"flex justify-between text-sm font-semibold\">\r\n              <span>Total Hours</span>\r\n              <span>{computedTotals.hours.toFixed(2)}h</span>\r\n            </div>\r\n            <div className=\"flex justify-between text-sm font-semibold mt-2\">\r\n              <span>Total Amount</span>\r\n              <span>{dataService.formatCurrency(computedTotals.amount)}</span>\r\n            </div>\r\n            <div className=\"flex gap-2 mt-4\">\r\n              <Button onClick={printInvoice} className=\"flex-1\" size=\"small\" aria-label=\"Print invoice\">Print</Button>\r\n              <Button variant=\"secondary\" onClick={exportCSV} className=\"flex-1\" size=\"small\" aria-label=\"Export invoice CSV\">CSV</Button>\r\n            </div>\r\n          </Card>\r\n        </>\r\n      )}\r\n      \r\n      {/* Help Text */}\r\n      {appData.entries.filter(e => e.end).length === 0 && (\r\n        <Card>\r\n          <div className=\"text-center py-6 text-gray-600\">\r\n            <p className=\"mb-2\">No completed time entries found.</p>\r\n            <p>Start tracking time to generate invoices!</p>\r\n          </div>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InvoiceTab;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}