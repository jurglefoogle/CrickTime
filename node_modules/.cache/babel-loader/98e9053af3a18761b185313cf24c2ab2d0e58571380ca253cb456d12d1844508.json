{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\jurgl\\\\HTMLProjects\\\\CrickTime\\\\src\\\\components\\\\tabs\\\\InvoiceTab.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useMemo } from 'react';\nimport Card from '../ui/Card';\nimport Button from '../ui/Button';\nimport Input from '../ui/Input';\nimport Select from '../ui/Select';\nimport { dataService } from '../../utils/dataService';\n\n/**\r\n * Invoice Tab Component\r\n * Reference: www.context7.com for invoice generation patterns\r\n */\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst InvoiceTab = ({\n  appData,\n  updateAppData,\n  invoiceContext,\n  clearInvoiceContext\n}) => {\n  _s();\n  const [selectedClient, setSelectedClient] = useState('');\n  const [startDate, setStartDate] = useState('');\n  const [endDate, setEndDate] = useState('');\n  const [invoiceData, setInvoiceData] = useState(null); // holds draft or finalized invoice meta & all candidate line items\n  const [selectedIds, setSelectedIds] = useState(new Set());\n  const [finalized, setFinalized] = useState(false);\n  const [mode, setMode] = useState(invoiceContext !== null && invoiceContext !== void 0 && invoiceContext.jobId ? 'job' : 'client'); // 'client' | 'job'\n  const [selectedJobId, setSelectedJobId] = useState((invoiceContext === null || invoiceContext === void 0 ? void 0 : invoiceContext.jobId) || '');\n  const [closeJobOnFinalize, setCloseJobOnFinalize] = useState(false);\n\n  // Get client options\n  const clientOptions = appData.clients.map(client => ({\n    value: client.id,\n    label: client.name\n  }));\n\n  // Generate draft invoice data (does NOT mark entries/charges invoiced yet)\n  const generateInvoice = () => {\n    if (!selectedClient || !startDate || !endDate) {\n      alert('Please select a client and date range');\n      return;\n    }\n    if (mode === 'job' && !selectedJobId) {\n      alert('Select a job for Job mode');\n      return;\n    }\n    const client = appData.clients.find(c => c.id === selectedClient);\n    if (!client) {\n      alert('Selected client not found');\n      return;\n    }\n    const start = new Date(startDate);\n    const end = new Date(endDate);\n    end.setHours(23, 59, 59, 999); // Include full end date\n\n    if (start > end) {\n      alert('Start date must be before end date');\n      return;\n    }\n\n    // Get entries for the client and date range\n    const clientEntries = appData.entries.filter(entry => {\n      if (!entry.end || entry.clientId !== selectedClient) return false;\n      if (entry.invoiced) return false; // skip already invoiced\n      if (mode === 'job' && entry.jobId !== selectedJobId) return false;\n      const entryDate = new Date(entry.start);\n      return entryDate >= start && entryDate <= end;\n    });\n\n    // Get charges for client within date range\n    const clientCharges = (appData.charges || []).filter(ch => {\n      if (ch.invoiced) return false;\n      if (ch.clientId !== selectedClient) return false;\n      if (mode === 'job' && ch.jobId !== selectedJobId) return false;\n      const chDate = new Date(ch.createdAt);\n      return chDate >= start && chDate <= end;\n    });\n    if (clientEntries.length === 0 && clientCharges.length === 0) {\n      alert('No billable entries or charges found for the selected criteria');\n      return;\n    }\n\n    // Create candidate line items (all initially selected)\n    const timeLineItems = clientEntries.map(entry => {\n      const taskName = entry.taskName || 'Unknown Task';\n      const duration = entry.end - entry.start;\n      const hours = dataService.durationToHours(duration);\n      const amount = hours * client.rate;\n      return {\n        id: entry.id,\n        date: dataService.formatDate(entry.start),\n        task: taskName,\n        notes: entry.notes || '',\n        hours: hours,\n        rate: client.rate,\n        amount: amount\n      };\n    });\n    const chargeLineItems = clientCharges.map(ch => ({\n      id: ch.id,\n      kind: 'charge',\n      chargeType: ch.kind,\n      date: dataService.formatDate(ch.createdAt),\n      task: ch.description,\n      notes: '',\n      hours: 0,\n      rate: ch.unitPrice,\n      quantity: ch.quantity,\n      amount: ch.amountCached\n    }));\n    const lineItems = [...timeLineItems, ...chargeLineItems];\n    const jobMeta = mode === 'job' ? (appData.jobs || []).find(j => j.id === selectedJobId) : null;\n    const invoice = {\n      client,\n      dateRange: {\n        start: dataService.formatDate(start),\n        end: dataService.formatDate(end)\n      },\n      lineItems,\n      job: jobMeta ? {\n        id: jobMeta.id,\n        name: jobMeta.name\n      } : null,\n      generatedDate: dataService.formatDate(new Date()),\n      invoiceNumber: `INV-${Date.now()}`\n    };\n    setInvoiceData(invoice);\n    setSelectedIds(new Set(lineItems.map(li => li.id)));\n    setFinalized(false);\n  };\n\n  // Toggle selection of a line item\n  const toggleLineItem = id => {\n    if (finalized) return;\n    setSelectedIds(prev => {\n      const next = new Set(prev);\n      if (next.has(id)) next.delete(id);else next.add(id);\n      return next;\n    });\n  };\n  const selectAll = () => {\n    if (!invoiceData || finalized) return;\n    setSelectedIds(new Set(invoiceData.lineItems.map(li => li.id)));\n  };\n  const clearAll = () => {\n    if (finalized) return;\n    setSelectedIds(new Set());\n  };\n\n  // Compute totals from selected items\n  const selectedLineItems = useMemo(() => {\n    if (!invoiceData) return [];\n    return invoiceData.lineItems.filter(li => selectedIds.has(li.id));\n  }, [invoiceData, selectedIds]);\n  const computedTotals = useMemo(() => {\n    const hours = selectedLineItems.reduce((s, i) => s + i.hours, 0);\n    const amount = selectedLineItems.reduce((s, i) => s + i.amount, 0);\n    return {\n      hours,\n      amount\n    };\n  }, [selectedLineItems]);\n\n  // Finalize invoice: mark selected entries as invoiced & persist snapshot history\n  const finalizeInvoice = () => {\n    var _invoiceData$job;\n    if (!invoiceData) return;\n    if (selectedIds.size === 0) {\n      alert('Select at least one line item to finalize the invoice.');\n      return;\n    }\n    const updatedEntries = appData.entries.map(e => selectedIds.has(e.id) ? {\n      ...e,\n      invoiced: true\n    } : e);\n    const updatedCharges = (appData.charges || []).map(c => selectedIds.has(c.id) ? {\n      ...c,\n      invoiced: true\n    } : c);\n    const snapshot = {\n      id: dataService.generateId(),\n      invoiceNumber: invoiceData.invoiceNumber,\n      clientId: invoiceData.client.id,\n      jobId: ((_invoiceData$job = invoiceData.job) === null || _invoiceData$job === void 0 ? void 0 : _invoiceData$job.id) || null,\n      dateRange: invoiceData.dateRange,\n      generatedAt: Date.now(),\n      lineItems: selectedLineItems.map(li => ({\n        id: li.id,\n        date: li.date,\n        task: li.task,\n        notes: li.notes,\n        hours: li.hours,\n        rate: li.rate,\n        amount: li.amount\n      })),\n      subtotal: computedTotals.amount,\n      total: computedTotals.amount\n    };\n    let patch = {\n      entries: updatedEntries,\n      charges: updatedCharges,\n      invoices: [...(appData.invoices || []), snapshot]\n    };\n    if (closeJobOnFinalize && invoiceData.job) {\n      const updatedJobs = (appData.jobs || []).map(j => j.id === invoiceData.job.id ? {\n        ...j,\n        closed: true,\n        closedAt: Date.now()\n      } : j);\n      patch.jobs = updatedJobs;\n    }\n    updateAppData(patch);\n    setFinalized(true);\n  };\n\n  // Export invoice as CSV\n  const exportCSV = () => {\n    if (!invoiceData) return;\n    const headers = ['Date', 'Task', 'Notes', 'Hours', 'Rate', 'Amount'];\n    const rows = selectedLineItems.map(item => [item.date, item.task, item.notes, item.hours.toFixed(2), item.rate.toFixed(2), item.amount.toFixed(2)]);\n\n    // Add totals row\n    rows.push(['', '', 'TOTAL', computedTotals.hours.toFixed(2), '', computedTotals.amount.toFixed(2)]);\n    const csvContent = [headers, ...rows].map(row => row.map(cell => `\"${cell}\"`).join(',')).join('\\n');\n    const blob = new Blob([csvContent], {\n      type: 'text/csv'\n    });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `invoice-${invoiceData.client.name}-${invoiceData.dateRange.start}-to-${invoiceData.dateRange.end}.csv`;\n    link.click();\n    URL.revokeObjectURL(url);\n  };\n\n  // Print invoice\n  const printInvoice = () => {\n    if (!invoiceData) return;\n    const printWindow = window.open('', '_blank');\n    const printContent = generatePrintHTML({\n      ...invoiceData,\n      lineItems: selectedLineItems,\n      totals: computedTotals\n    });\n    printWindow.document.write(printContent);\n    printWindow.document.close();\n    printWindow.focus();\n    printWindow.print();\n  };\n\n  // Generate HTML for printing\n  const generatePrintHTML = invoice => {\n    return `\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Invoice - ${invoice.client.name}</title>\n    <style>\n        body { font-family: Arial, sans-serif; margin: 40px; color: #333; }\n        .header { text-align: center; margin-bottom: 40px; }\n        .invoice-title { font-size: 28px; font-weight: bold; color: #2563eb; }\n        .invoice-info { display: flex; justify-content: space-between; margin-bottom: 30px; }\n        .client-info h3, .invoice-details h3 { margin-top: 0; color: #374151; }\n        table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }\n        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #e5e7eb; }\n        th { background-color: #f9fafb; font-weight: bold; }\n        .amount { text-align: right; }\n        .totals { font-weight: bold; background-color: #f3f4f6; }\n        .footer { margin-top: 40px; text-align: center; color: #6b7280; font-size: 14px; }\n        @media print {\n            body { margin: 20px; }\n            .no-print { display: none; }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <div class=\"invoice-title\">INVOICE</div>\n        <div style=\"margin-top: 10px; color: #6b7280;\">Mechanic Hours Time Tracking</div>\n    </div>\n    \n    <div class=\"invoice-info\">\n        <div class=\"client-info\">\n            <h3>Bill To:</h3>\n            <div><strong>${invoice.client.name}</strong></div>\n            ${invoice.client.contact ? `<div>${invoice.client.contact}</div>` : ''}\n        </div>\n        \n        <div class=\"invoice-details\">\n            <h3>Invoice Details:</h3>\n            <div><strong>Invoice #:</strong> ${invoice.invoiceNumber}</div>\n            <div><strong>Date:</strong> ${invoice.generatedDate}</div>\n            <div><strong>Period:</strong> ${invoice.dateRange.start} - ${invoice.dateRange.end}</div>\n        </div>\n    </div>\n    \n    <table>\n        <thead>\n            <tr>\n                <th>Date</th>\n                <th>Task</th>\n                <th>Notes</th>\n                <th>Hours</th>\n                <th>Rate</th>\n                <th class=\"amount\">Amount</th>\n            </tr>\n        </thead>\n        <tbody>\n            ${invoice.lineItems.map(item => `\n                <tr>\n                    <td>${item.date}</td>\n                    <td>${item.task}</td>\n                    <td>${item.notes}</td>\n                    <td>${item.hours.toFixed(2)}</td>\n                    <td>${dataService.formatCurrency(item.rate)}</td>\n                    <td class=\"amount\">${dataService.formatCurrency(item.amount)}</td>\n                </tr>\n            `).join('')}\n      <tr class=\"totals\">\n        <td colspan=\"3\">TOTAL</td>\n        <td><strong>${invoice.totals.hours.toFixed(2)}</strong></td>\n        <td></td>\n        <td class=\"amount\"><strong>${dataService.formatCurrency(invoice.totals.amount)}</strong></td>\n      </tr>\n        </tbody>\n    </table>\n    \n    <div class=\"footer\">\n        <p>Generated by Mechanic Hours - www.context7.com</p>\n        <p>Thank you for your business!</p>\n    </div>\n</body>\n</html>\n    `;\n  };\n\n  // Clear invoice\n  const clearInvoice = () => {\n    setInvoiceData(null);\n    setSelectedClient('');\n    setStartDate('');\n    setEndDate('');\n    setSelectedIds(new Set());\n    setFinalized(false);\n    setSelectedJobId('');\n    setMode('client');\n    setCloseJobOnFinalize(false);\n    clearInvoiceContext && clearInvoiceContext();\n  };\n\n  // Set quick date ranges\n  const setThisWeek = () => {\n    const now = new Date();\n    const startOfWeek = new Date(now);\n    startOfWeek.setDate(now.getDate() - now.getDay()); // Start of week (Sunday)\n\n    setStartDate(startOfWeek.toISOString().slice(0, 10));\n    setEndDate(now.toISOString().slice(0, 10));\n  };\n  const setThisMonth = () => {\n    const now = new Date();\n    const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);\n    setStartDate(startOfMonth.toISOString().slice(0, 10));\n    setEndDate(now.toISOString().slice(0, 10));\n  };\n  const setLastMonth = () => {\n    const now = new Date();\n    const startOfLastMonth = new Date(now.getFullYear(), now.getMonth() - 1, 1);\n    const endOfLastMonth = new Date(now.getFullYear(), now.getMonth(), 0);\n    setStartDate(startOfLastMonth.toISOString().slice(0, 10));\n    setEndDate(endOfLastMonth.toISOString().slice(0, 10));\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: [!invoiceData ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Card, {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl font-bold mb-4\",\n          children: \"Generate Invoice\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 376,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex gap-2 mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            size: \"small\",\n            variant: mode === 'client' ? 'primary' : 'secondary',\n            onClick: () => setMode('client'),\n            \"aria-label\": \"Invoice by client\",\n            children: \"By Client\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 379,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            size: \"small\",\n            variant: mode === 'job' ? 'primary' : 'secondary',\n            onClick: () => setMode('job'),\n            \"aria-label\": \"Invoice by job\",\n            children: \"By Job\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 380,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 378,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Select, {\n          label: \"Client\",\n          value: selectedClient,\n          onChange: e => {\n            setSelectedClient(e.target.value);\n            if (mode === 'job') setSelectedJobId('');\n          },\n          options: clientOptions,\n          placeholder: \"Select a client\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 383,\n          columnNumber: 13\n        }, this), mode === 'job' && selectedClient && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"input-label\",\n            children: \"Job\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 393,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            className: \"select\",\n            value: selectedJobId,\n            onChange: e => setSelectedJobId(e.target.value),\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"-- Select Job --\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 399,\n              columnNumber: 19\n            }, this), (appData.jobs || []).filter(j => !j.closed).filter(j => (appData.entries || []).some(e => e.jobId === j.id && e.clientId === selectedClient && e.end && !e.invoiced)).sort((a, b) => a.name.localeCompare(b.name)).map(j => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: j.id,\n              children: j.name\n            }, j.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 404,\n              columnNumber: 31\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 394,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 392,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 md:grid-cols-2 gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(Input, {\n            label: \"Start Date\",\n            type: \"date\",\n            value: startDate,\n            onChange: e => setStartDate(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 410,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            label: \"End Date\",\n            type: \"date\",\n            value: endDate,\n            onChange: e => setEndDate(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 417,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 409,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-wrap gap-2 mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            variant: \"secondary\",\n            size: \"small\",\n            onClick: setThisWeek,\n            \"aria-label\": \"Set date range to this week\",\n            children: \"This Week\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 427,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"secondary\",\n            size: \"small\",\n            onClick: setThisMonth,\n            \"aria-label\": \"Set date range to this month\",\n            children: \"This Month\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 430,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"secondary\",\n            size: \"small\",\n            onClick: setLastMonth,\n            \"aria-label\": \"Set date range to last month\",\n            children: \"Last Month\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 433,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 426,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: generateInvoice,\n          className: \"w-full\",\n          disabled: !selectedClient || !startDate || !endDate || mode === 'job' && !selectedJobId,\n          children: [\"\\uD83D\\uDCC4 Generate \", mode === 'job' ? 'Job' : 'Client', \" Invoice\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 438,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 375,\n        columnNumber: 11\n      }, this), appData.clients.length > 0 && /*#__PURE__*/_jsxDEV(Card, {\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold mb-4\",\n          children: \"Quick Stats\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 450,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 md:grid-cols-3 gap-4 text-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-2xl font-bold text-primary-600\",\n              children: appData.clients.length\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 453,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-600\",\n              children: \"Active Clients\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 456,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 452,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-2xl font-bold text-green-600\",\n              children: appData.entries.filter(e => e.end).length\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 459,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-600\",\n              children: \"Completed Entries\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 462,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 458,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-2xl font-bold text-blue-600\",\n              children: [dataService.calculateTotalHours(appData.entries.filter(e => e.end)).toFixed(1), \"h\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 465,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-600\",\n              children: \"Total Hours\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 468,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 464,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 451,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 449,\n        columnNumber: 13\n      }, this), appData.invoices && appData.invoices.length > 0 && /*#__PURE__*/_jsxDEV(Card, {\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold mb-3\",\n          children: \"Invoice History\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 476,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2 max-h-56 overflow-y-auto\",\n          children: appData.invoices.slice().sort((a, b) => b.generatedAt - a.generatedAt).map(inv => {\n            const client = appData.clients.find(c => c.id === inv.clientId);\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"individual-job-card\",\n              style: {\n                marginBottom: 0\n              },\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"job-card-content\",\n                style: {\n                  alignItems: 'center'\n                },\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"job-main-info\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"job-title\",\n                    children: inv.invoiceNumber\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 484,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"schedule-compact-row\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"job-time\",\n                      children: [inv.dateRange.start, \" \\u2192 \", inv.dateRange.end]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 486,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"schedule-meta-divider\",\n                      children: \"\\u2022\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 487,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"job-client\",\n                      children: (client === null || client === void 0 ? void 0 : client.name) || 'Unknown Client'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 488,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"schedule-meta-divider\",\n                      children: \"\\u2022\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 489,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"job-time\",\n                      children: dataService.formatCurrency(inv.total)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 490,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 485,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 483,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 482,\n                columnNumber: 23\n              }, this)\n            }, inv.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 481,\n              columnNumber: 21\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 477,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 475,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(Card, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-start mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"text-xl font-bold\",\n              children: \"Invoice\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 506,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-500\",\n              children: [invoiceData.invoiceNumber, !finalized && ' (Draft)', \" \", invoiceData.job && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ml-1 px-1 rounded bg-blue-600 text-white text-xs\",\n                children: [\"Job: \", invoiceData.job.name]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 507,\n                columnNumber: 128\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 507,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xs text-gray-500\",\n              children: [invoiceData.dateRange.start, \" - \", invoiceData.dateRange.end]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 508,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 505,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"secondary\",\n            size: \"small\",\n            onClick: clearInvoice,\n            children: \"Back\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 510,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 504,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"font-semibold\",\n            children: invoiceData.client.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 513,\n            columnNumber: 15\n          }, this), invoiceData.client.contact && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-gray-400\",\n            children: invoiceData.client.contact\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 514,\n            columnNumber: 46\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 512,\n          columnNumber: 13\n        }, this), !finalized && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-wrap gap-2 mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            size: \"small\",\n            variant: \"secondary\",\n            onClick: selectAll,\n            \"aria-label\": \"Select all line items\",\n            children: \"Select All\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 519,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            size: \"small\",\n            variant: \"secondary\",\n            onClick: clearAll,\n            \"aria-label\": \"Clear all line items\",\n            children: \"Clear All\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 520,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            size: \"small\",\n            onClick: finalizeInvoice,\n            disabled: selectedIds.size === 0,\n            \"aria-label\": \"Finalize invoice and mark entries invoiced\",\n            children: \"Finalize & Mark Invoiced\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 521,\n            columnNumber: 17\n          }, this), invoiceData.job && /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"flex items-center gap-1 text-xs text-gray-400 ml-auto\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              checked: closeJobOnFinalize,\n              onChange: () => setCloseJobOnFinalize(v => !v)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 524,\n              columnNumber: 21\n            }, this), \" Close Job\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 523,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 518,\n          columnNumber: 15\n        }, this), finalized && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-2 text-xs text-green-600 font-medium\",\n          children: [\"Finalized \\u2022 \", selectedIds.size, \" items marked invoiced\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 531,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"activity-list\",\n          children: invoiceData.lineItems.map(item => {\n            const checked = selectedIds.has(item.id);\n            const disabled = finalized;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `individual-job-card ${!checked ? 'opacity-50' : ''}`,\n              style: {\n                position: 'relative'\n              },\n              children: [!finalized && /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"checkbox\",\n                checked: checked,\n                onChange: () => toggleLineItem(item.id),\n                style: {\n                  position: 'absolute',\n                  top: 6,\n                  left: 6,\n                  width: 16,\n                  height: 16\n                },\n                disabled: disabled,\n                title: \"Include in invoice\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 540,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"job-card-content\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"job-main-info\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"job-title\",\n                    children: item.task\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 551,\n                    columnNumber: 23\n                  }, this), item.kind === 'charge' ? /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"job-time\",\n                    children: [item.date, \" \\u2022 \", item.quantity, \" x \", dataService.formatCurrency(item.rate)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 553,\n                    columnNumber: 25\n                  }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"job-time\",\n                    children: [item.date, \" \\u2022 \", item.hours.toFixed(2), \"h @ \", dataService.formatCurrency(item.rate)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 555,\n                    columnNumber: 25\n                  }, this), item.notes && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"job-notes\",\n                    children: item.notes\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 557,\n                    columnNumber: 38\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 550,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"job-actions\",\n                  style: {\n                    alignItems: 'flex-end'\n                  },\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"stat-value stat-value-success\",\n                    style: {\n                      fontSize: '0.85rem'\n                    },\n                    children: dataService.formatCurrency(item.amount)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 560,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 559,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 549,\n                columnNumber: 19\n              }, this)]\n            }, item.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 538,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 533,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"separator\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 566,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between text-sm font-semibold\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Total Hours\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 568,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [computedTotals.hours.toFixed(2), \"h\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 569,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 567,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between text-sm font-semibold mt-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Total Amount\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 572,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: dataService.formatCurrency(computedTotals.amount)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 573,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 571,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex gap-2 mt-4\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            onClick: printInvoice,\n            className: \"flex-1\",\n            size: \"small\",\n            \"aria-label\": \"Print invoice\",\n            children: \"Print\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 576,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"secondary\",\n            onClick: exportCSV,\n            className: \"flex-1\",\n            size: \"small\",\n            \"aria-label\": \"Export invoice CSV\",\n            children: \"CSV\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 577,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 575,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 503,\n        columnNumber: 11\n      }, this)\n    }, void 0, false), appData.entries.filter(e => e.end).length === 0 && /*#__PURE__*/_jsxDEV(Card, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center py-6 text-gray-600\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mb-2\",\n          children: \"No completed time entries found.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 587,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Start tracking time to generate invoices!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 588,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 586,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 585,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 371,\n    columnNumber: 5\n  }, this);\n};\n_s(InvoiceTab, \"nvsceRoGGKz7dc30dftme7W/CTo=\");\n_c = InvoiceTab;\nexport default InvoiceTab;\nvar _c;\n$RefreshReg$(_c, \"InvoiceTab\");","map":{"version":3,"names":["React","useState","useMemo","Card","Button","Input","Select","dataService","jsxDEV","_jsxDEV","Fragment","_Fragment","InvoiceTab","appData","updateAppData","invoiceContext","clearInvoiceContext","_s","selectedClient","setSelectedClient","startDate","setStartDate","endDate","setEndDate","invoiceData","setInvoiceData","selectedIds","setSelectedIds","Set","finalized","setFinalized","mode","setMode","jobId","selectedJobId","setSelectedJobId","closeJobOnFinalize","setCloseJobOnFinalize","clientOptions","clients","map","client","value","id","label","name","generateInvoice","alert","find","c","start","Date","end","setHours","clientEntries","entries","filter","entry","clientId","invoiced","entryDate","clientCharges","charges","ch","chDate","createdAt","length","timeLineItems","taskName","duration","hours","durationToHours","amount","rate","date","formatDate","task","notes","chargeLineItems","kind","chargeType","description","unitPrice","quantity","amountCached","lineItems","jobMeta","jobs","j","invoice","dateRange","job","generatedDate","invoiceNumber","now","li","toggleLineItem","prev","next","has","delete","add","selectAll","clearAll","selectedLineItems","computedTotals","reduce","s","i","finalizeInvoice","_invoiceData$job","size","updatedEntries","e","updatedCharges","snapshot","generateId","generatedAt","subtotal","total","patch","invoices","updatedJobs","closed","closedAt","exportCSV","headers","rows","item","toFixed","push","csvContent","row","cell","join","blob","Blob","type","url","URL","createObjectURL","link","document","createElement","href","download","click","revokeObjectURL","printInvoice","printWindow","window","open","printContent","generatePrintHTML","totals","write","close","focus","print","contact","formatCurrency","clearInvoice","setThisWeek","startOfWeek","setDate","getDate","getDay","toISOString","slice","setThisMonth","startOfMonth","getFullYear","getMonth","setLastMonth","startOfLastMonth","endOfLastMonth","className","children","fileName","_jsxFileName","lineNumber","columnNumber","variant","onClick","onChange","target","options","placeholder","some","sort","a","b","localeCompare","disabled","calculateTotalHours","inv","style","marginBottom","alignItems","checked","v","position","top","left","width","height","title","fontSize","_c","$RefreshReg$"],"sources":["C:/Users/jurgl/HTMLProjects/CrickTime/src/components/tabs/InvoiceTab.js"],"sourcesContent":["import React, { useState, useMemo } from 'react';\r\nimport Card from '../ui/Card';\r\nimport Button from '../ui/Button';\r\nimport Input from '../ui/Input';\r\nimport Select from '../ui/Select';\r\nimport { dataService } from '../../utils/dataService';\r\n\r\n/**\r\n * Invoice Tab Component\r\n * Reference: www.context7.com for invoice generation patterns\r\n */\r\nconst InvoiceTab = ({ appData, updateAppData, invoiceContext, clearInvoiceContext }) => {\r\n  const [selectedClient, setSelectedClient] = useState('');\r\n  const [startDate, setStartDate] = useState('');\r\n  const [endDate, setEndDate] = useState('');\r\n  const [invoiceData, setInvoiceData] = useState(null); // holds draft or finalized invoice meta & all candidate line items\r\n  const [selectedIds, setSelectedIds] = useState(new Set());\r\n  const [finalized, setFinalized] = useState(false);\r\n  const [mode, setMode] = useState(invoiceContext?.jobId ? 'job' : 'client'); // 'client' | 'job'\r\n  const [selectedJobId, setSelectedJobId] = useState(invoiceContext?.jobId || '');\r\n  const [closeJobOnFinalize, setCloseJobOnFinalize] = useState(false);\r\n\r\n  // Get client options\r\n  const clientOptions = appData.clients.map(client => ({\r\n    value: client.id,\r\n    label: client.name\r\n  }));\r\n\r\n  // Generate draft invoice data (does NOT mark entries/charges invoiced yet)\r\n  const generateInvoice = () => {\r\n    if (!selectedClient || !startDate || !endDate) {\r\n      alert('Please select a client and date range');\r\n      return;\r\n    }\r\n\r\n    if (mode === 'job' && !selectedJobId) {\r\n      alert('Select a job for Job mode');\r\n      return;\r\n    }\r\n\r\n    const client = appData.clients.find(c => c.id === selectedClient);\r\n    if (!client) {\r\n      alert('Selected client not found');\r\n      return;\r\n    }\r\n\r\n    const start = new Date(startDate);\r\n    const end = new Date(endDate);\r\n    end.setHours(23, 59, 59, 999); // Include full end date\r\n\r\n    if (start > end) {\r\n      alert('Start date must be before end date');\r\n      return;\r\n    }\r\n\r\n    // Get entries for the client and date range\r\n    const clientEntries = appData.entries.filter(entry => {\r\n      if (!entry.end || entry.clientId !== selectedClient) return false;\r\n      if (entry.invoiced) return false; // skip already invoiced\r\n      if (mode === 'job' && entry.jobId !== selectedJobId) return false;\r\n      \r\n      const entryDate = new Date(entry.start);\r\n      return entryDate >= start && entryDate <= end;\r\n    });\r\n\r\n    // Get charges for client within date range\r\n    const clientCharges = (appData.charges||[]).filter(ch => {\r\n      if (ch.invoiced) return false;\r\n      if (ch.clientId !== selectedClient) return false;\r\n      if (mode === 'job' && ch.jobId !== selectedJobId) return false;\r\n      const chDate = new Date(ch.createdAt);\r\n      return chDate >= start && chDate <= end;\r\n    });\r\n\r\n    if (clientEntries.length === 0 && clientCharges.length === 0) {\r\n      alert('No billable entries or charges found for the selected criteria');\r\n      return;\r\n    }\r\n\r\n  // Create candidate line items (all initially selected)\r\n  const timeLineItems = clientEntries.map(entry => {\r\n      const taskName = entry.taskName || 'Unknown Task';\r\n      const duration = entry.end - entry.start;\r\n      const hours = dataService.durationToHours(duration);\r\n      const amount = hours * client.rate;\r\n\r\n      return {\r\n        id: entry.id,\r\n        date: dataService.formatDate(entry.start),\r\n        task: taskName,\r\n        notes: entry.notes || '',\r\n        hours: hours,\r\n        rate: client.rate,\r\n        amount: amount\r\n      };\r\n    });\r\n\r\n    const chargeLineItems = clientCharges.map(ch => ({\r\n      id: ch.id,\r\n      kind: 'charge',\r\n      chargeType: ch.kind,\r\n      date: dataService.formatDate(ch.createdAt),\r\n      task: ch.description,\r\n      notes: '',\r\n      hours: 0,\r\n      rate: ch.unitPrice,\r\n      quantity: ch.quantity,\r\n      amount: ch.amountCached\r\n    }));\r\n\r\n    const lineItems = [...timeLineItems, ...chargeLineItems];\r\n\r\n    const jobMeta = mode === 'job' ? (appData.jobs || []).find(j => j.id === selectedJobId) : null;\r\n    const invoice = {\r\n      client,\r\n      dateRange: {\r\n        start: dataService.formatDate(start),\r\n        end: dataService.formatDate(end)\r\n      },\r\n      lineItems,\r\n      job: jobMeta ? { id: jobMeta.id, name: jobMeta.name } : null,\r\n      generatedDate: dataService.formatDate(new Date()),\r\n      invoiceNumber: `INV-${Date.now()}`\r\n    };\r\n\r\n    setInvoiceData(invoice);\r\n  setSelectedIds(new Set(lineItems.map(li => li.id)));\r\n    setFinalized(false);\r\n  };\r\n\r\n  // Toggle selection of a line item\r\n  const toggleLineItem = (id) => {\r\n    if (finalized) return;\r\n    setSelectedIds(prev => {\r\n      const next = new Set(prev);\r\n      if (next.has(id)) next.delete(id); else next.add(id);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const selectAll = () => {\r\n    if (!invoiceData || finalized) return;\r\n    setSelectedIds(new Set(invoiceData.lineItems.map(li => li.id)));\r\n  };\r\n\r\n  const clearAll = () => {\r\n    if (finalized) return;\r\n    setSelectedIds(new Set());\r\n  };\r\n\r\n  // Compute totals from selected items\r\n  const selectedLineItems = useMemo(() => {\r\n    if (!invoiceData) return [];\r\n    return invoiceData.lineItems.filter(li => selectedIds.has(li.id));\r\n  }, [invoiceData, selectedIds]);\r\n\r\n  const computedTotals = useMemo(() => {\r\n    const hours = selectedLineItems.reduce((s, i) => s + i.hours, 0);\r\n    const amount = selectedLineItems.reduce((s, i) => s + i.amount, 0);\r\n    return { hours, amount };\r\n  }, [selectedLineItems]);\r\n\r\n  // Finalize invoice: mark selected entries as invoiced & persist snapshot history\r\n  const finalizeInvoice = () => {\r\n    if (!invoiceData) return;\r\n    if (selectedIds.size === 0) {\r\n      alert('Select at least one line item to finalize the invoice.');\r\n      return;\r\n    }\r\n  const updatedEntries = appData.entries.map(e => selectedIds.has(e.id) ? { ...e, invoiced: true } : e);\r\n  const updatedCharges = (appData.charges||[]).map(c => selectedIds.has(c.id) ? { ...c, invoiced: true } : c);\r\n    const snapshot = {\r\n      id: dataService.generateId(),\r\n      invoiceNumber: invoiceData.invoiceNumber,\r\n      clientId: invoiceData.client.id,\r\n      jobId: invoiceData.job?.id || null,\r\n      dateRange: invoiceData.dateRange,\r\n      generatedAt: Date.now(),\r\n      lineItems: selectedLineItems.map(li => ({\r\n        id: li.id,\r\n        date: li.date,\r\n        task: li.task,\r\n        notes: li.notes,\r\n        hours: li.hours,\r\n        rate: li.rate,\r\n        amount: li.amount\r\n      })),\r\n      subtotal: computedTotals.amount,\r\n      total: computedTotals.amount\r\n    };\r\n  let patch = { entries: updatedEntries, charges: updatedCharges, invoices: [...(appData.invoices||[]), snapshot] };\r\n    if (closeJobOnFinalize && invoiceData.job) {\r\n      const updatedJobs = (appData.jobs || []).map(j => j.id === invoiceData.job.id ? { ...j, closed: true, closedAt: Date.now() } : j);\r\n      patch.jobs = updatedJobs;\r\n    }\r\n    updateAppData(patch);\r\n    setFinalized(true);\r\n  };\r\n\r\n  // Export invoice as CSV\r\n  const exportCSV = () => {\r\n    if (!invoiceData) return;\r\n\r\n    const headers = ['Date', 'Task', 'Notes', 'Hours', 'Rate', 'Amount'];\r\n    const rows = selectedLineItems.map(item => [\r\n      item.date,\r\n      item.task,\r\n      item.notes,\r\n      item.hours.toFixed(2),\r\n      item.rate.toFixed(2),\r\n      item.amount.toFixed(2)\r\n    ]);\r\n\r\n    // Add totals row\r\n    rows.push(['', '', 'TOTAL', computedTotals.hours.toFixed(2), '', computedTotals.amount.toFixed(2)]);\r\n\r\n    const csvContent = [headers, ...rows]\r\n      .map(row => row.map(cell => `\"${cell}\"`).join(','))\r\n      .join('\\n');\r\n\r\n    const blob = new Blob([csvContent], { type: 'text/csv' });\r\n    const url = URL.createObjectURL(blob);\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    link.download = `invoice-${invoiceData.client.name}-${invoiceData.dateRange.start}-to-${invoiceData.dateRange.end}.csv`;\r\n    link.click();\r\n    URL.revokeObjectURL(url);\r\n  };\r\n\r\n  // Print invoice\r\n  const printInvoice = () => {\r\n    if (!invoiceData) return;\r\n\r\n    const printWindow = window.open('', '_blank');\r\n    const printContent = generatePrintHTML({ ...invoiceData, lineItems: selectedLineItems, totals: computedTotals });\r\n    \r\n    printWindow.document.write(printContent);\r\n    printWindow.document.close();\r\n    printWindow.focus();\r\n    printWindow.print();\r\n  };\r\n\r\n  // Generate HTML for printing\r\n  const generatePrintHTML = (invoice) => {\r\n    return `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n    <title>Invoice - ${invoice.client.name}</title>\r\n    <style>\r\n        body { font-family: Arial, sans-serif; margin: 40px; color: #333; }\r\n        .header { text-align: center; margin-bottom: 40px; }\r\n        .invoice-title { font-size: 28px; font-weight: bold; color: #2563eb; }\r\n        .invoice-info { display: flex; justify-content: space-between; margin-bottom: 30px; }\r\n        .client-info h3, .invoice-details h3 { margin-top: 0; color: #374151; }\r\n        table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }\r\n        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #e5e7eb; }\r\n        th { background-color: #f9fafb; font-weight: bold; }\r\n        .amount { text-align: right; }\r\n        .totals { font-weight: bold; background-color: #f3f4f6; }\r\n        .footer { margin-top: 40px; text-align: center; color: #6b7280; font-size: 14px; }\r\n        @media print {\r\n            body { margin: 20px; }\r\n            .no-print { display: none; }\r\n        }\r\n    </style>\r\n</head>\r\n<body>\r\n    <div class=\"header\">\r\n        <div class=\"invoice-title\">INVOICE</div>\r\n        <div style=\"margin-top: 10px; color: #6b7280;\">Mechanic Hours Time Tracking</div>\r\n    </div>\r\n    \r\n    <div class=\"invoice-info\">\r\n        <div class=\"client-info\">\r\n            <h3>Bill To:</h3>\r\n            <div><strong>${invoice.client.name}</strong></div>\r\n            ${invoice.client.contact ? `<div>${invoice.client.contact}</div>` : ''}\r\n        </div>\r\n        \r\n        <div class=\"invoice-details\">\r\n            <h3>Invoice Details:</h3>\r\n            <div><strong>Invoice #:</strong> ${invoice.invoiceNumber}</div>\r\n            <div><strong>Date:</strong> ${invoice.generatedDate}</div>\r\n            <div><strong>Period:</strong> ${invoice.dateRange.start} - ${invoice.dateRange.end}</div>\r\n        </div>\r\n    </div>\r\n    \r\n    <table>\r\n        <thead>\r\n            <tr>\r\n                <th>Date</th>\r\n                <th>Task</th>\r\n                <th>Notes</th>\r\n                <th>Hours</th>\r\n                <th>Rate</th>\r\n                <th class=\"amount\">Amount</th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            ${invoice.lineItems.map(item => `\r\n                <tr>\r\n                    <td>${item.date}</td>\r\n                    <td>${item.task}</td>\r\n                    <td>${item.notes}</td>\r\n                    <td>${item.hours.toFixed(2)}</td>\r\n                    <td>${dataService.formatCurrency(item.rate)}</td>\r\n                    <td class=\"amount\">${dataService.formatCurrency(item.amount)}</td>\r\n                </tr>\r\n            `).join('')}\r\n      <tr class=\"totals\">\r\n        <td colspan=\"3\">TOTAL</td>\r\n        <td><strong>${invoice.totals.hours.toFixed(2)}</strong></td>\r\n        <td></td>\r\n        <td class=\"amount\"><strong>${dataService.formatCurrency(invoice.totals.amount)}</strong></td>\r\n      </tr>\r\n        </tbody>\r\n    </table>\r\n    \r\n    <div class=\"footer\">\r\n        <p>Generated by Mechanic Hours - www.context7.com</p>\r\n        <p>Thank you for your business!</p>\r\n    </div>\r\n</body>\r\n</html>\r\n    `;\r\n  };\r\n\r\n  // Clear invoice\r\n  const clearInvoice = () => {\r\n    setInvoiceData(null);\r\n    setSelectedClient('');\r\n    setStartDate('');\r\n    setEndDate('');\r\n    setSelectedIds(new Set());\r\n    setFinalized(false);\r\n    setSelectedJobId('');\r\n    setMode('client');\r\n    setCloseJobOnFinalize(false);\r\n    clearInvoiceContext && clearInvoiceContext();\r\n  };\r\n\r\n  // Set quick date ranges\r\n  const setThisWeek = () => {\r\n    const now = new Date();\r\n    const startOfWeek = new Date(now);\r\n    startOfWeek.setDate(now.getDate() - now.getDay()); // Start of week (Sunday)\r\n    \r\n    setStartDate(startOfWeek.toISOString().slice(0, 10));\r\n    setEndDate(now.toISOString().slice(0, 10));\r\n  };\r\n\r\n  const setThisMonth = () => {\r\n    const now = new Date();\r\n    const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);\r\n    \r\n    setStartDate(startOfMonth.toISOString().slice(0, 10));\r\n    setEndDate(now.toISOString().slice(0, 10));\r\n  };\r\n\r\n  const setLastMonth = () => {\r\n    const now = new Date();\r\n    const startOfLastMonth = new Date(now.getFullYear(), now.getMonth() - 1, 1);\r\n    const endOfLastMonth = new Date(now.getFullYear(), now.getMonth(), 0);\r\n    \r\n    setStartDate(startOfLastMonth.toISOString().slice(0, 10));\r\n    setEndDate(endOfLastMonth.toISOString().slice(0, 10));\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n  {!invoiceData ? (\r\n        <>\r\n          {/* Invoice Generation Form */}\r\n          <Card>\r\n            <h2 className=\"text-xl font-bold mb-4\">Generate Invoice</h2>\r\n\r\n            <div className=\"flex gap-2 mb-3\">\r\n              <Button size=\"small\" variant={mode==='client'?'primary':'secondary'} onClick={()=>setMode('client')} aria-label=\"Invoice by client\">By Client</Button>\r\n              <Button size=\"small\" variant={mode==='job'?'primary':'secondary'} onClick={()=>setMode('job')} aria-label=\"Invoice by job\">By Job</Button>\r\n            </div>\r\n            \r\n            <Select\r\n              label=\"Client\"\r\n              value={selectedClient}\r\n              onChange={(e) => { setSelectedClient(e.target.value); if(mode==='job') setSelectedJobId(''); }}\r\n              options={clientOptions}\r\n              placeholder=\"Select a client\"\r\n            />\r\n\r\n      {mode === 'job' && selectedClient && (\r\n              <div className=\"mb-3\">\r\n                <label className=\"input-label\">Job</label>\r\n                <select\r\n                  className=\"select\"\r\n                  value={selectedJobId}\r\n                  onChange={(e)=>setSelectedJobId(e.target.value)}\r\n                >\r\n                  <option value=\"\">-- Select Job --</option>\r\n                  {(appData.jobs||[])\r\n                    .filter(j=>!j.closed)\r\n        .filter(j=> (appData.entries||[]).some(e=>e.jobId===j.id && e.clientId===selectedClient && e.end && !e.invoiced))\r\n                    .sort((a,b)=>a.name.localeCompare(b.name))\r\n                    .map(j => <option key={j.id} value={j.id}>{j.name}</option>)}\r\n                </select>\r\n              </div>\r\n            )}\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n              <Input\r\n                label=\"Start Date\"\r\n                type=\"date\"\r\n                value={startDate}\r\n                onChange={(e) => setStartDate(e.target.value)}\r\n              />\r\n              \r\n              <Input\r\n                label=\"End Date\"\r\n                type=\"date\"\r\n                value={endDate}\r\n                onChange={(e) => setEndDate(e.target.value)}\r\n              />\r\n            </div>\r\n            \r\n            {/* Quick Date Buttons */}\r\n            <div className=\"flex flex-wrap gap-2 mb-4\">\r\n              <Button variant=\"secondary\" size=\"small\" onClick={setThisWeek} aria-label=\"Set date range to this week\">\r\n                This Week\r\n              </Button>\r\n              <Button variant=\"secondary\" size=\"small\" onClick={setThisMonth} aria-label=\"Set date range to this month\">\r\n                This Month\r\n              </Button>\r\n              <Button variant=\"secondary\" size=\"small\" onClick={setLastMonth} aria-label=\"Set date range to last month\">\r\n                Last Month\r\n              </Button>\r\n            </div>\r\n            \r\n            <Button \r\n              onClick={generateInvoice}\r\n              className=\"w-full\"\r\n              disabled={!selectedClient || !startDate || !endDate || (mode==='job' && !selectedJobId)}\r\n            >\r\n               Generate {mode==='job' ? 'Job' : 'Client'} Invoice\r\n            </Button>\r\n          </Card>\r\n\r\n          {/* Summary Statistics */}\r\n          {appData.clients.length > 0 && (\r\n            <Card>\r\n              <h3 className=\"text-lg font-semibold mb-4\">Quick Stats</h3>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-center\">\r\n                <div>\r\n                  <div className=\"text-2xl font-bold text-primary-600\">\r\n                    {appData.clients.length}\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-600\">Active Clients</div>\r\n                </div>\r\n                <div>\r\n                  <div className=\"text-2xl font-bold text-green-600\">\r\n                    {appData.entries.filter(e => e.end).length}\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-600\">Completed Entries</div>\r\n                </div>\r\n                <div>\r\n                  <div className=\"text-2xl font-bold text-blue-600\">\r\n                    {dataService.calculateTotalHours(appData.entries.filter(e => e.end)).toFixed(1)}h\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-600\">Total Hours</div>\r\n                </div>\r\n              </div>\r\n            </Card>\r\n          )}\r\n          {/* Invoice History Stub */}\r\n          { (appData.invoices && appData.invoices.length > 0) && (\r\n            <Card>\r\n              <h3 className=\"text-lg font-semibold mb-3\">Invoice History</h3>\r\n              <div className=\"space-y-2 max-h-56 overflow-y-auto\">\r\n                {appData.invoices.slice().sort((a,b)=>b.generatedAt - a.generatedAt).map(inv => {\r\n                  const client = appData.clients.find(c=>c.id===inv.clientId);\r\n                  return (\r\n                    <div key={inv.id} className=\"individual-job-card\" style={{marginBottom:0}}>\r\n                      <div className=\"job-card-content\" style={{alignItems:'center'}}>\r\n                        <div className=\"job-main-info\">\r\n                          <div className=\"job-title\">{inv.invoiceNumber}</div>\r\n                          <div className=\"schedule-compact-row\">\r\n                            <span className=\"job-time\">{inv.dateRange.start}  {inv.dateRange.end}</span>\r\n                            <span className=\"schedule-meta-divider\"></span>\r\n                            <span className=\"job-client\">{client?.name || 'Unknown Client'}</span>\r\n                            <span className=\"schedule-meta-divider\"></span>\r\n                            <span className=\"job-time\">{dataService.formatCurrency(inv.total)}</span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            </Card>\r\n          )}\r\n        </>\r\n      ) : (\r\n        <>\r\n          <Card>\r\n            <div className=\"flex justify-between items-start mb-4\">\r\n              <div>\r\n                <h2 className=\"text-xl font-bold\">Invoice</h2>\r\n                <p className=\"text-sm text-gray-500\">{invoiceData.invoiceNumber}{!finalized && ' (Draft)'} {invoiceData.job && <span className=\"ml-1 px-1 rounded bg-blue-600 text-white text-xs\">Job: {invoiceData.job.name}</span>}</p>\r\n                <p className=\"text-xs text-gray-500\">{invoiceData.dateRange.start} - {invoiceData.dateRange.end}</p>\r\n              </div>\r\n              <Button variant=\"secondary\" size=\"small\" onClick={clearInvoice}>Back</Button>\r\n            </div>\r\n            <div className=\"mb-4\">\r\n              <div className=\"font-semibold\">{invoiceData.client.name}</div>\r\n              {invoiceData.client.contact && <div className=\"text-xs text-gray-400\">{invoiceData.client.contact}</div>}\r\n            </div>\r\n\r\n            {!finalized && (\r\n              <div className=\"flex flex-wrap gap-2 mb-3\">\r\n                <Button size=\"small\" variant=\"secondary\" onClick={selectAll} aria-label=\"Select all line items\">Select All</Button>\r\n                <Button size=\"small\" variant=\"secondary\" onClick={clearAll} aria-label=\"Clear all line items\">Clear All</Button>\r\n                <Button size=\"small\" onClick={finalizeInvoice} disabled={selectedIds.size === 0} aria-label=\"Finalize invoice and mark entries invoiced\">Finalize & Mark Invoiced</Button>\r\n                {invoiceData.job && (\r\n                  <label className=\"flex items-center gap-1 text-xs text-gray-400 ml-auto\">\r\n                    <input type=\"checkbox\" checked={closeJobOnFinalize} onChange={()=>setCloseJobOnFinalize(v=>!v)} /> Close Job\r\n                  </label>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {finalized && (\r\n              <div className=\"mb-2 text-xs text-green-600 font-medium\">Finalized  {selectedIds.size} items marked invoiced</div>\r\n            )}\r\n            <div className=\"activity-list\">\r\n              {invoiceData.lineItems.map(item => {\r\n                const checked = selectedIds.has(item.id);\r\n                const disabled = finalized;\r\n                return (\r\n                <div key={item.id} className={`individual-job-card ${!checked ? 'opacity-50' : ''}`} style={{position:'relative'}}>\r\n                  {!finalized && (\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={checked}\r\n                      onChange={() => toggleLineItem(item.id)}\r\n                      style={{position:'absolute', top:6, left:6, width:16, height:16}}\r\n                      disabled={disabled}\r\n                      title=\"Include in invoice\"\r\n                    />\r\n                  )}\r\n                  <div className=\"job-card-content\">\r\n                    <div className=\"job-main-info\">\r\n                      <div className=\"job-title\">{item.task}</div>\r\n                      {item.kind === 'charge' ? (\r\n                        <div className=\"job-time\">{item.date}  {item.quantity} x {dataService.formatCurrency(item.rate)}</div>\r\n                      ) : (\r\n                        <div className=\"job-time\">{item.date}  {item.hours.toFixed(2)}h @ {dataService.formatCurrency(item.rate)}</div>\r\n                      )}\r\n                      {item.notes && <div className=\"job-notes\">{item.notes}</div>}\r\n                    </div>\r\n                    <div className=\"job-actions\" style={{alignItems:'flex-end'}}>\r\n                      <div className=\"stat-value stat-value-success\" style={{fontSize:'0.85rem'}}>{dataService.formatCurrency(item.amount)}</div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )})}\r\n            </div>\r\n            <div className=\"separator\" />\r\n            <div className=\"flex justify-between text-sm font-semibold\">\r\n              <span>Total Hours</span>\r\n              <span>{computedTotals.hours.toFixed(2)}h</span>\r\n            </div>\r\n            <div className=\"flex justify-between text-sm font-semibold mt-2\">\r\n              <span>Total Amount</span>\r\n              <span>{dataService.formatCurrency(computedTotals.amount)}</span>\r\n            </div>\r\n            <div className=\"flex gap-2 mt-4\">\r\n              <Button onClick={printInvoice} className=\"flex-1\" size=\"small\" aria-label=\"Print invoice\">Print</Button>\r\n              <Button variant=\"secondary\" onClick={exportCSV} className=\"flex-1\" size=\"small\" aria-label=\"Export invoice CSV\">CSV</Button>\r\n            </div>\r\n          </Card>\r\n        </>\r\n      )}\r\n      \r\n      {/* Help Text */}\r\n      {appData.entries.filter(e => e.end).length === 0 && (\r\n        <Card>\r\n          <div className=\"text-center py-6 text-gray-600\">\r\n            <p className=\"mb-2\">No completed time entries found.</p>\r\n            <p>Start tracking time to generate invoices!</p>\r\n          </div>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InvoiceTab;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}