{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\jurgl\\\\HTMLProjects\\\\CrickTime\\\\src\\\\index.js\";\nimport React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport App from './App';\n\n// Register service worker for PWA functionality only in production.\n// In development, attempt to unregister to avoid stale-cache issues.\n// Reference: www.context7.com for PWA best practices\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nif (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n  // Capture deferred install prompt\n  let deferredPrompt = null;\n  window.addEventListener('beforeinstallprompt', e => {\n    e.preventDefault();\n    deferredPrompt = e;\n    window._showInstallPrompt = async () => {\n      if (!deferredPrompt) return false;\n      deferredPrompt.prompt();\n      const choice = await deferredPrompt.userChoice;\n      deferredPrompt = null;\n      return choice.outcome === 'accepted';\n    };\n    console.log('PWA: beforeinstallprompt captured');\n  });\n  window.addEventListener('load', () => {\n    const basePath = window.location.pathname.includes('/CrickTime/') ? '/CrickTime' : '';\n    navigator.serviceWorker.register(`${basePath}/sw.js`).then(registration => {\n      console.log('SW registered:', registration.scope);\n      registration.addEventListener('updatefound', () => {\n        const newWorker = registration.installing;\n        if (newWorker) {\n          newWorker.addEventListener('statechange', () => {\n            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {\n              console.log('SW: New version available (will activate on next load)');\n            }\n          });\n        }\n      });\n    }).catch(err => console.log('SW registration failed:', err));\n  });\n\n  // Listen for messages from service worker\n  navigator.serviceWorker.addEventListener('message', event => {\n    if (event.data && event.data.type === 'SW_UPDATED') {\n      console.log('SW: Update message received');\n    } else if (event.data && event.data.type === 'CACHE_CLEARED') {\n      console.log('SW: Cache cleared successfully');\n    }\n  });\n\n  // Add global function for clearing cache (useful for debugging)\n  window.clearAppCache = () => {\n    if (navigator.serviceWorker.controller) {\n      navigator.serviceWorker.controller.postMessage({\n        type: 'CLEAR_CACHE'\n      });\n      console.log('SW: Cache clear requested');\n    } else {\n      console.log('SW: No service worker controller available');\n    }\n  };\n\n  // Local backup/export utilities\n  window.exportLocalData = () => {\n    try {\n      const raw = localStorage.getItem('appData');\n      if (!raw) {\n        alert('No data to export');\n        return;\n      }\n      const blob = new Blob([raw], {\n        type: 'application/json'\n      });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      const ts = new Date().toISOString().slice(0, 10);\n      a.download = `cricktime-backup-${ts}.json`;\n      a.click();\n      URL.revokeObjectURL(url);\n    } catch (e) {\n      console.error('Export failed', e);\n      alert('Export failed');\n    }\n  };\n  window.importLocalData = file => {\n    if (!file) return;\n    const reader = new FileReader();\n    reader.onload = e => {\n      try {\n        const parsed = JSON.parse(e.target.result);\n        if (!parsed || typeof parsed !== 'object') throw new Error('Invalid');\n        localStorage.setItem('appData', JSON.stringify(parsed));\n        alert('Data imported. Reloading...');\n        window.location.reload();\n      } catch (err) {\n        console.error('Import failed', err);\n        alert('Invalid backup file');\n      }\n    };\n    reader.readAsText(file);\n  };\n} else if ('serviceWorker' in navigator) {\n  // Development: proactively unregister any existing service workers on load\n  window.addEventListener('load', async () => {\n    try {\n      const regs = await navigator.serviceWorker.getRegistrations();\n      await Promise.all(regs.map(r => r.unregister()));\n      // After unregister, a hard reload ensures no SW control\n      // Note: not forcing reload here to avoid loops; user can hard refresh if needed.\n      console.log('SW (dev): Unregistered all service workers');\n    } catch (e) {\n      console.log('SW (dev): Unregister failed or none present');\n    }\n  });\n}\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(/*#__PURE__*/_jsxDEV(React.StrictMode, {\n  children: /*#__PURE__*/_jsxDEV(App, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 120,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 119,\n  columnNumber: 3\n}, this));","map":{"version":3,"names":["React","ReactDOM","App","jsxDEV","_jsxDEV","process","env","NODE_ENV","navigator","deferredPrompt","window","addEventListener","e","preventDefault","_showInstallPrompt","prompt","choice","userChoice","outcome","console","log","basePath","location","pathname","includes","serviceWorker","register","then","registration","scope","newWorker","installing","state","controller","catch","err","event","data","type","clearAppCache","postMessage","exportLocalData","raw","localStorage","getItem","alert","blob","Blob","url","URL","createObjectURL","a","document","createElement","href","ts","Date","toISOString","slice","download","click","revokeObjectURL","error","importLocalData","file","reader","FileReader","onload","parsed","JSON","parse","target","result","Error","setItem","stringify","reload","readAsText","regs","getRegistrations","Promise","all","map","r","unregister","root","createRoot","getElementById","render","StrictMode","children","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["C:/Users/jurgl/HTMLProjects/CrickTime/src/index.js"],"sourcesContent":["import React from 'react';\r\nimport ReactDOM from 'react-dom/client';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\n// Register service worker for PWA functionality only in production.\r\n// In development, attempt to unregister to avoid stale-cache issues.\r\n// Reference: www.context7.com for PWA best practices\r\nif (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n  // Capture deferred install prompt\r\n  let deferredPrompt = null;\r\n  window.addEventListener('beforeinstallprompt', (e) => {\r\n    e.preventDefault();\r\n    deferredPrompt = e;\r\n    window._showInstallPrompt = async () => {\r\n      if (!deferredPrompt) return false;\r\n      deferredPrompt.prompt();\r\n      const choice = await deferredPrompt.userChoice;\r\n      deferredPrompt = null;\r\n      return choice.outcome === 'accepted';\r\n    };\r\n    console.log('PWA: beforeinstallprompt captured');\r\n  });\r\n\r\n  window.addEventListener('load', () => {\r\n    const basePath = window.location.pathname.includes('/CrickTime/') ? '/CrickTime' : '';\r\n    navigator.serviceWorker.register(`${basePath}/sw.js`)\r\n      .then((registration) => {\r\n        console.log('SW registered:', registration.scope);\r\n        registration.addEventListener('updatefound', () => {\r\n          const newWorker = registration.installing;\r\n          if (newWorker) {\r\n            newWorker.addEventListener('statechange', () => {\r\n              if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {\r\n                console.log('SW: New version available (will activate on next load)');\r\n              }\r\n            });\r\n          }\r\n        });\r\n      })\r\n      .catch(err => console.log('SW registration failed:', err));\r\n  });\r\n  \r\n  // Listen for messages from service worker\r\n  navigator.serviceWorker.addEventListener('message', (event) => {\r\n    if (event.data && event.data.type === 'SW_UPDATED') {\r\n  console.log('SW: Update message received');\r\n    } else if (event.data && event.data.type === 'CACHE_CLEARED') {\r\n      console.log('SW: Cache cleared successfully');\r\n    }\r\n  });\r\n  \r\n  // Add global function for clearing cache (useful for debugging)\r\n  window.clearAppCache = () => {\r\n    if (navigator.serviceWorker.controller) {\r\n      navigator.serviceWorker.controller.postMessage({ type: 'CLEAR_CACHE' });\r\n      console.log('SW: Cache clear requested');\r\n    } else {\r\n      console.log('SW: No service worker controller available');\r\n    }\r\n  };\r\n\r\n  // Local backup/export utilities\r\n  window.exportLocalData = () => {\r\n    try {\r\n      const raw = localStorage.getItem('appData');\r\n      if (!raw) {\r\n        alert('No data to export');\r\n        return;\r\n      }\r\n      const blob = new Blob([raw], { type: 'application/json' });\r\n      const url = URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      const ts = new Date().toISOString().slice(0,10);\r\n      a.download = `cricktime-backup-${ts}.json`;\r\n      a.click();\r\n      URL.revokeObjectURL(url);\r\n    } catch (e) {\r\n      console.error('Export failed', e);\r\n      alert('Export failed');\r\n    }\r\n  };\r\n\r\n  window.importLocalData = (file) => {\r\n    if (!file) return;\r\n    const reader = new FileReader();\r\n    reader.onload = (e) => {\r\n      try {\r\n        const parsed = JSON.parse(e.target.result);\r\n        if (!parsed || typeof parsed !== 'object') throw new Error('Invalid');\r\n        localStorage.setItem('appData', JSON.stringify(parsed));\r\n        alert('Data imported. Reloading...');\r\n        window.location.reload();\r\n      } catch (err) {\r\n        console.error('Import failed', err);\r\n        alert('Invalid backup file');\r\n      }\r\n    };\r\n    reader.readAsText(file);\r\n  };\r\n} else if ('serviceWorker' in navigator) {\r\n  // Development: proactively unregister any existing service workers on load\r\n  window.addEventListener('load', async () => {\r\n    try {\r\n      const regs = await navigator.serviceWorker.getRegistrations();\r\n      await Promise.all(regs.map(r => r.unregister()));\r\n      // After unregister, a hard reload ensures no SW control\r\n      // Note: not forcing reload here to avoid loops; user can hard refresh if needed.\r\n      console.log('SW (dev): Unregistered all service workers');\r\n    } catch (e) {\r\n      console.log('SW (dev): Unregister failed or none present');\r\n    }\r\n  });\r\n}\r\n\r\nconst root = ReactDOM.createRoot(document.getElementById('root'));\r\nroot.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>\r\n);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}